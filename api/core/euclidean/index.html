
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://jg1011.github.io/PyDynSys/api/core/euclidean/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="phase_space/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Overview - PyDynSys</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#coreeuclidean-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="PyDynSys" class="md-header__button md-logo" aria-label="PyDynSys" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyDynSys
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Overview
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/jg1011/PyDynSys" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getting_started/installation/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples/phase_spaces_and_time_horizons/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="PyDynSys" class="md-nav__button md-logo" aria-label="PyDynSys" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    PyDynSys
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jg1011/PyDynSys" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Core
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1_2" checked>
        
          
          <label class="md-nav__link" for="__nav_3_1_2" id="__nav_3_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Euclidean
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_1_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1_2">
            <span class="md-nav__icon md-icon"></span>
            Euclidean
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamical-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamical Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamical Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#euclideands" class="md-nav__link">
    <span class="md-ellipsis">
      EuclideanDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autonomouseuclideands" class="md-nav__link">
    <span class="md-ellipsis">
      AutonomousEuclideanDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonautonomouseuclideands" class="md-nav__link">
    <span class="md-ellipsis">
      NonAutonomousEuclideanDS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trajectory-types" class="md-nav__link">
    <span class="md-ellipsis">
      Trajectory Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trajectory Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#euclideantrajectorysegment" class="md-nav__link">
    <span class="md-ellipsis">
      EuclideanTrajectorySegment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#euclideantrajectory" class="md-nav__link">
    <span class="md-ellipsis">
      EuclideanTrajectory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-space-and-time" class="md-nav__link">
    <span class="md-ellipsis">
      Phase Space and Time
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase Space and Time">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phasespace" class="md-nav__link">
    <span class="md-ellipsis">
      PhaseSpace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timehorizon" class="md-nav__link">
    <span class="md-ellipsis">
      TimeHorizon
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-docs" class="md-nav__link">
    <span class="md-ellipsis">
      Full Docs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean" class="md-nav__link">
    <span class="md-ellipsis">
      euclidean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="euclidean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS" class="md-nav__link">
    <span class="md-ellipsis">
      AutonomousEuclideanDS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutonomousEuclideanDS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS--harmonic-oscillator-x-x-0-x-y-y-x" class="md-nav__link">
    <span class="md-ellipsis">
      Harmonic oscillator: x'' + x = 0 → (x, y)' = (y, -x)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS.vector_field" class="md-nav__link">
    <span class="md-ellipsis">
      vector_field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS.evolve" class="md-nav__link">
    <span class="md-ellipsis">
      evolve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS.trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      trajectory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS" class="md-nav__link">
    <span class="md-ellipsis">
      EuclideanDS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EuclideanDS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.vector_field" class="md-nav__link">
    <span class="md-ellipsis">
      vector_field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.from_symbolic" class="md-nav__link">
    <span class="md-ellipsis">
      from_symbolic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_symbolic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.from_symbolic--autonomous-system" class="md-nav__link">
    <span class="md-ellipsis">
      Autonomous system
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.phase_space_distance" class="md-nav__link">
    <span class="md-ellipsis">
      phase_space_distance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.phase_space_volume" class="md-nav__link">
    <span class="md-ellipsis">
      phase_space_volume
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS" class="md-nav__link">
    <span class="md-ellipsis">
      NonAutonomousEuclideanDS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NonAutonomousEuclideanDS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS--driven-harmonic-oscillator-x-x-sint" class="md-nav__link">
    <span class="md-ellipsis">
      Driven harmonic oscillator: x'' + x = sin(t)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.vector_field" class="md-nav__link">
    <span class="md-ellipsis">
      vector_field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.evolve" class="md-nav__link">
    <span class="md-ellipsis">
      evolve
    </span>
  </a>
  
    <nav class="md-nav" aria-label="evolve">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.evolve--driven-oscillator-evolves-differently-at-different-times" class="md-nav__link">
    <span class="md-ellipsis">
      Driven oscillator evolves differently at different times
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.find_global_equilibria" class="md-nav__link">
    <span class="md-ellipsis">
      find_global_equilibria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.find_instantaneous_equilibria" class="md-nav__link">
    <span class="md-ellipsis">
      find_instantaneous_equilibria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      trajectory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace" class="md-nav__link">
    <span class="md-ellipsis">
      PhaseSpace
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PhaseSpace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.volume" class="md-nav__link">
    <span class="md-ellipsis">
      volume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.box" class="md-nav__link">
    <span class="md-ellipsis">
      box
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.closed_hypersphere" class="md-nav__link">
    <span class="md-ellipsis">
      closed_hypersphere
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.contains_point" class="md-nav__link">
    <span class="md-ellipsis">
      contains_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.contains_points" class="md-nav__link">
    <span class="md-ellipsis">
      contains_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.full" class="md-nav__link">
    <span class="md-ellipsis">
      full
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.open_hypersphere" class="md-nav__link">
    <span class="md-ellipsis">
      open_hypersphere
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon" class="md-nav__link">
    <span class="md-ellipsis">
      TimeHorizon
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeHorizon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.length" class="md-nav__link">
    <span class="md-ellipsis">
      length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.closed_interval" class="md-nav__link">
    <span class="md-ellipsis">
      closed_interval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.contains_time" class="md-nav__link">
    <span class="md-ellipsis">
      contains_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.contains_times" class="md-nav__link">
    <span class="md-ellipsis">
      contains_times
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.open_interval" class="md-nav__link">
    <span class="md-ellipsis">
      open_interval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.real_line" class="md-nav__link">
    <span class="md-ellipsis">
      real_line
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="phase_space/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PhaseSpace
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="time_horizon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TimeHorizon
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="trajectory_segment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TrajectorySegment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="trajectory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trajectory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Vis
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Vis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Euclidean
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Euclidean
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vis/euclidean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../vis/euclidean/phase_space/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PhaseSpace
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples/phase_spaces_and_time_horizons/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using Custom Phase Spaces and Time Horizons
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    <span class="md-ellipsis">
      Classes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dynamical-systems" class="md-nav__link">
    <span class="md-ellipsis">
      Dynamical Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dynamical Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#euclideands" class="md-nav__link">
    <span class="md-ellipsis">
      EuclideanDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autonomouseuclideands" class="md-nav__link">
    <span class="md-ellipsis">
      AutonomousEuclideanDS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nonautonomouseuclideands" class="md-nav__link">
    <span class="md-ellipsis">
      NonAutonomousEuclideanDS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trajectory-types" class="md-nav__link">
    <span class="md-ellipsis">
      Trajectory Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Trajectory Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#euclideantrajectorysegment" class="md-nav__link">
    <span class="md-ellipsis">
      EuclideanTrajectorySegment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#euclideantrajectory" class="md-nav__link">
    <span class="md-ellipsis">
      EuclideanTrajectory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-space-and-time" class="md-nav__link">
    <span class="md-ellipsis">
      Phase Space and Time
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase Space and Time">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phasespace" class="md-nav__link">
    <span class="md-ellipsis">
      PhaseSpace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timehorizon" class="md-nav__link">
    <span class="md-ellipsis">
      TimeHorizon
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#full-docs" class="md-nav__link">
    <span class="md-ellipsis">
      Full Docs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean" class="md-nav__link">
    <span class="md-ellipsis">
      euclidean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="euclidean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS" class="md-nav__link">
    <span class="md-ellipsis">
      AutonomousEuclideanDS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AutonomousEuclideanDS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS--harmonic-oscillator-x-x-0-x-y-y-x" class="md-nav__link">
    <span class="md-ellipsis">
      Harmonic oscillator: x'' + x = 0 → (x, y)' = (y, -x)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS.vector_field" class="md-nav__link">
    <span class="md-ellipsis">
      vector_field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS.evolve" class="md-nav__link">
    <span class="md-ellipsis">
      evolve
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.AutonomousEuclideanDS.trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      trajectory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS" class="md-nav__link">
    <span class="md-ellipsis">
      EuclideanDS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EuclideanDS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.vector_field" class="md-nav__link">
    <span class="md-ellipsis">
      vector_field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.from_symbolic" class="md-nav__link">
    <span class="md-ellipsis">
      from_symbolic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_symbolic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.from_symbolic--autonomous-system" class="md-nav__link">
    <span class="md-ellipsis">
      Autonomous system
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.phase_space_distance" class="md-nav__link">
    <span class="md-ellipsis">
      phase_space_distance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.EuclideanDS.phase_space_volume" class="md-nav__link">
    <span class="md-ellipsis">
      phase_space_volume
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS" class="md-nav__link">
    <span class="md-ellipsis">
      NonAutonomousEuclideanDS
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NonAutonomousEuclideanDS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS--driven-harmonic-oscillator-x-x-sint" class="md-nav__link">
    <span class="md-ellipsis">
      Driven harmonic oscillator: x'' + x = sin(t)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.vector_field" class="md-nav__link">
    <span class="md-ellipsis">
      vector_field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.evolve" class="md-nav__link">
    <span class="md-ellipsis">
      evolve
    </span>
  </a>
  
    <nav class="md-nav" aria-label="evolve">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.evolve--driven-oscillator-evolves-differently-at-different-times" class="md-nav__link">
    <span class="md-ellipsis">
      Driven oscillator evolves differently at different times
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.find_global_equilibria" class="md-nav__link">
    <span class="md-ellipsis">
      find_global_equilibria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.find_instantaneous_equilibria" class="md-nav__link">
    <span class="md-ellipsis">
      find_instantaneous_equilibria
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.NonAutonomousEuclideanDS.trajectory" class="md-nav__link">
    <span class="md-ellipsis">
      trajectory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace" class="md-nav__link">
    <span class="md-ellipsis">
      PhaseSpace
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PhaseSpace">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.volume" class="md-nav__link">
    <span class="md-ellipsis">
      volume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.box" class="md-nav__link">
    <span class="md-ellipsis">
      box
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.closed_hypersphere" class="md-nav__link">
    <span class="md-ellipsis">
      closed_hypersphere
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.contains_point" class="md-nav__link">
    <span class="md-ellipsis">
      contains_point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.contains_points" class="md-nav__link">
    <span class="md-ellipsis">
      contains_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.full" class="md-nav__link">
    <span class="md-ellipsis">
      full
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.PhaseSpace.open_hypersphere" class="md-nav__link">
    <span class="md-ellipsis">
      open_hypersphere
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon" class="md-nav__link">
    <span class="md-ellipsis">
      TimeHorizon
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TimeHorizon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.length" class="md-nav__link">
    <span class="md-ellipsis">
      length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.closed_interval" class="md-nav__link">
    <span class="md-ellipsis">
      closed_interval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.contains_time" class="md-nav__link">
    <span class="md-ellipsis">
      contains_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.contains_times" class="md-nav__link">
    <span class="md-ellipsis">
      contains_times
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.open_interval" class="md-nav__link">
    <span class="md-ellipsis">
      open_interval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#PyDynSys.core.euclidean.TimeHorizon.real_line" class="md-nav__link">
    <span class="md-ellipsis">
      real_line
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="coreeuclidean-module">Core.Euclidean Module</h1>
<h2 id="overview">Overview</h2>
<p>The <code>PyDynSys.core.euclidean</code> module provides classes for working with Euclidean dynamical systems, trajectories, phase spaces, and time horizons.</p>
<p>Let <span class="arithmatex">\(X \subseteq \mathbb{R}^n\)</span> and <span class="arithmatex">\(T \subseteq \mathbb{R}\)</span> be sets, let <span class="arithmatex">\({\bf F}: X \times T \to \mathbb{R}^n\)</span> be a vector field, and suppose on <span class="arithmatex">\(X \times T\)</span> the first-order ODE <span class="arithmatex">\(\dot{{\bf x}} = {\bf F}({\bf x}, t)\)</span> holds. This is the setting we work within. Formally, we define a <em>Euclidean dynamical system</em> by the tuple <span class="arithmatex">\((X, T, {\bf F})\)</span>. As the notation suggests, <span class="arithmatex">\({\bf x}: T \to \mathbb{R}^n\)</span> is a function of time. </p>
<p>There is an abstract base class <code>DynamicalSystem</code>, which all types of dynamical system inherit from. There are two top-level inheritors, which we expect almost all consumers to inherit from: <code>AutonomousDS</code> and <code>NonAutonomousDS</code>, corresponding to the cases where our Euclidean dynamical system is (or isn't) autonomous, i.e. whether <span class="arithmatex">\(\frac{\partial {\bf F}}{\partial t} \equiv 0\)</span>. In the autonomous case, where this is true, we need not specify <span class="arithmatex">\(T\)</span>, and we opt to consider a vector field <span class="arithmatex">\({\bf F}: X \to \mathbb{R}^n\)</span>. All non-autonomous systems can be trivially made autonomous, though in doing so we lose some topological structure. As such, we elect to support both autonomous systems and their non-autonomous cousins.  </p>
<h2 id="classes">Classes</h2>
<h3 id="dynamical-systems">Dynamical Systems</h3>
<h4 id="euclideands"><a href="base.md#euclideands">EuclideanDS</a></h4>
<p>Abstract base class for Euclidean dynamical systems. Provides shared infrastructure for autonomous and non-autonomous systems, including solution caching, validation, and trajectory solving.</p>
<h4 id="autonomouseuclideands"><a href="autonomous.md#autonomouseuclideands">AutonomousEuclideanDS</a></h4>
<p>Systems where dx/dt = F(x) with F: R^n -&gt; R^n independent of time. Suitable for time-invariant systems.</p>
<h4 id="nonautonomouseuclideands"><a href="non_autonomous.md#nonautonomouseuclideands">NonAutonomousEuclideanDS</a></h4>
<p>Systems where dx/dt = F(x, t) with F: R^n × R -&gt; R^n dependent on time. Suitable for time-varying systems.</p>
<h3 id="trajectory-types">Trajectory Types</h3>
<h4 id="euclideantrajectorysegment"><a href="trajectory.md#euclideantrajectorysegment">EuclideanTrajectorySegment</a></h4>
<p>Represents a single continuous trajectory segment from a numerical integration solve.</p>
<h4 id="euclideantrajectory"><a href="trajectory.md#euclideantrajectory">EuclideanTrajectory</a></h4>
<p>Composed trajectory that can span multiple segments, supporting bidirectional integration and trajectory composition.</p>
<h3 id="phase-space-and-time">Phase Space and Time</h3>
<h4 id="phasespace"><a href="phase_space/">PhaseSpace</a></h4>
<p>Phase space representation with flexible symbolic and callable constraints. Supports various factory methods for common geometric shapes (boxes, hyperspheres) and custom constraints.</p>
<h4 id="timehorizon"><a href="time_horizon.md#timehorizon">TimeHorizon</a></h4>
<p>Time domain representation for dynamical systems, supporting real line, intervals, and custom time domains.</p>
<h2 id="full-docs">Full Docs</h2>


<div class="doc doc-object doc-module">



<h2 id="PyDynSys.core.euclidean" class="doc doc-heading">
            <code>PyDynSys.core.euclidean</code>


</h2>

    <div class="doc doc-contents first">

        <p>Euclidean dynamical systems module.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="PyDynSys.core.euclidean.AutonomousEuclideanDS" class="doc doc-heading">
            <code>AutonomousEuclideanDS</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="EuclideanDS (PyDynSys.core.euclidean.base.EuclideanDS)" href="#PyDynSys.core.euclidean.EuclideanDS">EuclideanDS</a></code></p>


        <p>Autonomous Euclidean dynamical system.</p>
<p>Systems where dx/dt = F(x) with F: R^n -&gt; R^n independent of time.
Equivalently, Partial(df, dt) = 0. </p>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<h4 id="PyDynSys.core.euclidean.AutonomousEuclideanDS--harmonic-oscillator-x-x-0-x-y-y-x">Harmonic oscillator: x'' + x = 0 → (x, y)' = (y, -x)</h4>
<p>def harmonic_oscillator(x):
...     return np.array([x[1], -x[0]])
phase_space = PhaseSpace.euclidean(2)
sys = AutonomousEuclideanDS(
...     dimension=2, 
...     vector_field=harmonic_oscillator,
...     phase_space=phase_space
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="quote">
                <summary>Source code in <code>src/PyDynSys/core/euclidean/autonomous.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">AutonomousEuclideanDS</span><span class="p">(</span><span class="n">EuclideanDS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Autonomous Euclidean dynamical system.</span>

<span class="sd">    Systems where dx/dt = F(x) with F: R^n -&gt; R^n independent of time.</span>
<span class="sd">    Equivalently, Partial(df, dt) = 0. </span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # Harmonic oscillator: x&#39;&#39; + x = 0 → (x, y)&#39; = (y, -x)</span>
<span class="sd">        &gt;&gt;&gt; def harmonic_oscillator(x):</span>
<span class="sd">        ...     return np.array([x[1], -x[0]])</span>
<span class="sd">        &gt;&gt;&gt; phase_space = PhaseSpace.euclidean(2)</span>
<span class="sd">        &gt;&gt;&gt; sys = AutonomousEuclideanDS(</span>
<span class="sd">        ...     dimension=2, </span>
<span class="sd">        ...     vector_field=harmonic_oscillator,</span>
<span class="sd">        ...     phase_space=phase_space</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>


        <span class="c1">### --- Constructor --- ###</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
        <span class="n">vector_field</span><span class="p">:</span> <span class="n">AutonomousVectorField</span><span class="p">,</span>
        <span class="n">phase_space</span><span class="p">:</span> <span class="n">PhaseSpace</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize autonomous system.</span>

<span class="sd">        Args:</span>
<span class="sd">            dimension (int): Phase space dimension n</span>
<span class="sd">            vector_field: Function F(x) -&gt; dx/dt mapping R^n -&gt; R^n</span>
<span class="sd">            phase_space: Phase space X subset R^n (defaults to X = R^n)</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If dimension &lt;= 0 or phase_space dimension mismatch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Enforce default: X = R^n with symbolic representation</span>
        <span class="k">if</span> <span class="n">phase_space</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">phase_space</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="o">.</span><span class="n">euclidean</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">phase_space</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vector_field</span> <span class="o">=</span> <span class="n">vector_field</span>
        <span class="c1"># NOTE: Could validate vector_field signature here via inspect</span>


        <span class="c1">### --- EuclideanDS Method Impls --- ###</span>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vector_field</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AutonomousVectorField</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vector field defining the dynamical system.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vector_field</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">trajectory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">t_eval</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;RK45&#39;</span><span class="p">,</span>
        <span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EuclideanTrajectory</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve initial value problem: dx/dt = F(x), x(t_0) = x_0 over interval I.</span>

<span class="sd">        Supports bidirectional integration: if t_span = (t_0, t_end) where </span>
<span class="sd">        t_0 is interior to the t_eval range, performs:</span>
<span class="sd">        - Backward integration: t_0 → min(t_eval)</span>
<span class="sd">        - Forward integration: t_0 → max(t_eval)</span>
<span class="sd">        Then concatenates results.</span>

<span class="sd">        Args:</span>
<span class="sd">            initial_state: Initial condition x(t_0) ∈ R^n</span>
<span class="sd">            t_span: Effective integration bounds (t_start, t_end)</span>
<span class="sd">            t_eval: Evaluation points (may span both sides of an interior t_0)</span>
<span class="sd">            method: ODE solver (default &#39;RK45&#39; = 5th order Runge-Kutta w/ adaptive step size)</span>
<span class="sd">            dense_output: If True, returns continuous interpolant sol(t)</span>
<span class="sd">                -&gt; NOTE: I am yet to see a use case where not true is useful, and it comes </span>
<span class="sd">                at a minimal computational cost.</span>

<span class="sd">        Returns:</span>
<span class="sd">            EuclideanTrajectory: Trajectory object with attributes:</span>
<span class="sd">                - t: Evaluation times (property, concatenated from segments)</span>
<span class="sd">                - y: States at each time (property, concatenated from segments)</span>
<span class="sd">                - segments: List of trajectory segments</span>
<span class="sd">                - interpolate(t): Method for continuous evaluation at time t</span>
<span class="sd">                - domains: List of domain intervals for each segment</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If state dimension incorrect, t_span invalid, </span>
<span class="sd">                       or t_eval points outside valid range</span>

<span class="sd">        Implementation Notes:</span>
<span class="sd">            - Solutions cached by (initial_state, t_span, t_eval, method)</span>
<span class="sd">            - Integrator uses λ(t, x): self.vector_field(x) (ignores t)</span>
<span class="sd">            - Bidirectional: if t_0 interior to [min(t_eval), max(t_eval)]</span>
<span class="sd">            - No existence/uniqueness checks performed (TODO: future)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_time_span</span><span class="p">(</span><span class="n">t_span</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_t_eval</span><span class="p">(</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">t_span</span><span class="p">)</span>

        <span class="c1"># ====================================================================</span>
        <span class="c1"># CACHING STRATEGY</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># Check cache (removed method field - trajectories can be multi-method)</span>
        <span class="c1"># </span>
        <span class="c1"># Cache key includes: (x_0, t_0, t_eval) but NOT method</span>
        <span class="c1"># This allows cache hits even with different methods, which is reasonable because:</span>
        <span class="c1">#   1. Different methods solve the same IVP (should give similar results)</span>
        <span class="c1">#   2. Multi-method trajectories are valid (bidirectional with different methods)</span>
        <span class="c1">#   3. Simpler cache logic (no need to track method combinations)</span>
        <span class="c1">#</span>
        <span class="c1"># For autonomous systems, t_0 doesn&#39;t affect trajectory shape (time-translation</span>
        <span class="c1"># invariant), but we store it for consistency with non-autonomous systems and</span>
        <span class="c1"># potential future optimizations (e.g., recognizing time-shifted duplicates).</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="n">TrajectoryCacheKey</span><span class="p">(</span>
            <span class="n">initial_conditions</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">initial_state</span><span class="p">),</span>
            <span class="n">initial_time</span><span class="o">=</span><span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># Store t_0 (typically 0 for autonomous, but can vary)</span>
            <span class="n">t_eval_tuple</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Cache hit: Return previously computed trajectory (may have been computed with different method!)</span>
        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>

        <span class="c1"># ====================================================================</span>
        <span class="c1"># BIDIRECTIONAL INTEGRATION DETECTION</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># Determine if bidirectional integration needed</span>
        <span class="c1"># </span>
        <span class="c1"># Standard (unidirectional) integration: t_0 at boundary of t_eval range</span>
        <span class="c1">#   Example: t_0=0, t_eval=[0, 0.1, 0.2, ..., 10]</span>
        <span class="c1">#   Flow computed in ONE direction: forward from t_0 to max(t_eval)</span>
        <span class="c1">#</span>
        <span class="c1"># Bidirectional integration: t_0 INTERIOR to t_eval range</span>
        <span class="c1">#   Example: t_0=0, t_eval=[-5, -4, ..., -0.1, 0, 0.1, ..., 4, 5]</span>
        <span class="c1">#   Flow computed in TWO directions: </span>
        <span class="c1">#     - Backward from t_0 to min(t_eval)</span>
        <span class="c1">#     - Forward from t_0 to max(t_eval)</span>
        <span class="c1">#   This is useful for studying orbits, limit cycles, and phase portraits</span>
        <span class="c1">#   where we want to see the trajectory evolve both forward and backward in time</span>
        <span class="c1">#</span>
        <span class="c1"># NOTE: scipy.solve_ivp does NOT support bidirectional integration natively,</span>
        <span class="c1"># so we manually split into two IVPs and merge the resulting segments.</span>

        <span class="n">t_0</span> <span class="o">=</span> <span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Assume first element is initial time</span>
        <span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t_eval</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span>

        <span class="c1"># Check if we need backward integration (t_0 above minimum)</span>
        <span class="n">needs_backward</span> <span class="o">=</span> <span class="n">t_0</span> <span class="o">&gt;</span> <span class="n">t_min</span>
        <span class="c1"># Check if we need forward integration (t_0 below maximum)</span>
        <span class="n">needs_forward</span> <span class="o">=</span> <span class="n">t_0</span> <span class="o">&lt;</span> <span class="n">t_max</span>

        <span class="k">if</span> <span class="n">needs_backward</span> <span class="ow">and</span> <span class="n">needs_forward</span><span class="p">:</span>
            <span class="c1"># BIDIRECTIONAL CASE: t_0 is interior to [t_min, t_max]</span>
            <span class="c1"># Bidirectional case: integrate backwards and forwards</span>
            <span class="c1"># Create two segments and let Trajectory handle tangent domain at t_0</span>
            <span class="c1"># </span>
            <span class="c1"># DESIGN DECISION: Why not manually concatenate like before?</span>
            <span class="c1"># ----------------------------------------------------------</span>
            <span class="c1"># Old approach (removed): Manually concatenate t and y arrays, return single</span>
            <span class="c1">#   SciPyIvpSolution with sol=None (no interpolant possible)</span>
            <span class="c1"># </span>
            <span class="c1"># New approach: Create two segments, let EuclideanTrajectory.from_segments()</span>
            <span class="c1">#   handle merging. Benefits:</span>
            <span class="c1">#   1. Preserves BOTH interpolants (one for each segment)</span>
            <span class="c1">#   2. Allows seamless interpolation via trajectory.interpolate(t) dispatch</span>
            <span class="c1">#   3. Consistent with manual trajectory composition workflow</span>
            <span class="c1">#   4. Cleaner separation of concerns (merging logic in one place)</span>
            <span class="n">sol_backward_raw</span><span class="p">,</span> <span class="n">sol_forward_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_bidirectional_raw</span><span class="p">(</span>
                <span class="n">initial_state</span><span class="p">,</span> <span class="n">t_0</span><span class="p">,</span> <span class="n">t_eval</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">dense_output</span>
            <span class="p">)</span>

            <span class="c1"># Wrap raw scipy solutions in segments</span>
            <span class="c1"># Each segment preserves its interpolant if dense_output=True</span>
            <span class="n">seg_backward</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
                <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">sol_backward_raw</span><span class="p">),</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span>
            <span class="p">)</span>
            <span class="n">seg_forward</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
                <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">sol_forward_raw</span><span class="p">),</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span>
            <span class="p">)</span>

            <span class="c1"># Merge via trajectory (handles tangent domain automatically)</span>
            <span class="c1"># The segments share t_0 → average merge policy merges the shared point</span>
            <span class="c1"># Result: Single trajectory with 2 segments, tangent at t_0</span>
            <span class="n">trajectory</span> <span class="o">=</span> <span class="n">EuclideanTrajectory</span><span class="o">.</span><span class="n">from_segments</span><span class="p">([</span><span class="n">seg_backward</span><span class="p">,</span> <span class="n">seg_forward</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># UNIDIRECTIONAL CASE: Standard forward or backward integration</span>
            <span class="c1"># t_0 is at boundary of t_eval range (not interior)</span>
            <span class="c1"># </span>
            <span class="c1"># Even though this is a single scipy solve_ivp call, we STILL wrap it</span>
            <span class="c1"># in EuclideanTrajectory (with one segment) for API consistency.</span>
            <span class="c1"># </span>
            <span class="c1"># WHY? Uniform return type simplifies user code:</span>
            <span class="c1">#   result = sys.trajectory(...)  # Always get EuclideanTrajectory</span>
            <span class="c1">#   result.interpolate(t)          # Always works the same way</span>
            <span class="c1">#   result.segments                # Always accessible (just 1 segment here)</span>
            <span class="c1"># </span>
            <span class="c1"># User doesn&#39;t need to check &quot;is this bidirectional or unidirectional?&quot;</span>
            <span class="n">solution_raw</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
                <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>  <span class="c1"># Ignore time parameter (autonomous)</span>
                <span class="n">t_span</span><span class="o">=</span><span class="n">t_span</span><span class="p">,</span>
                <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span>
            <span class="p">)</span>

            <span class="c1"># Wrap scipy solution in segment, then wrap segment in trajectory</span>
            <span class="c1"># Result: EuclideanTrajectory with 1 segment</span>
            <span class="n">segment</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
                <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">solution_raw</span><span class="p">),</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span>
            <span class="p">)</span>
            <span class="n">trajectory</span> <span class="o">=</span> <span class="n">EuclideanTrajectory</span><span class="o">.</span><span class="n">from_segments</span><span class="p">([</span><span class="n">segment</span><span class="p">])</span>

        <span class="c1"># Cache and return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">trajectory</span>
        <span class="k">return</span> <span class="n">trajectory</span>


        <span class="c1">### --- Public Methods --- ###</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">evolve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;RK45&#39;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Single time-step evolution: estimate x(t_0 + dt) from x(t_0).</span>

<span class="sd">        Convenience wrapper for rapid single-step integration without caching.</span>
<span class="sd">        For repeated evaluations or bidirectional integration, use trajectory().</span>

<span class="sd">        Args:</span>
<span class="sd">            initial_state: State at time t_0</span>
<span class="sd">            t0: Initial time</span>
<span class="sd">            dt: Time step (must be positive)</span>
<span class="sd">            method: ODE solver</span>

<span class="sd">        Returns:</span>
<span class="sd">            NDArray[np.float64]: Estimated state at t_0 + dt</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If state dimension incorrect or dt ≤ 0</span>

<span class="sd">        NOTE: For backwards evolution or flow on intervals around t_0,</span>
<span class="sd">        use trajectory() instead which supports bidirectional integration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_time_step</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># Single-step integration without caching</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
            <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
            <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="p">),</span>
            <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
            <span class="n">t_eval</span><span class="o">=</span><span class="p">[</span><span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="p">],</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">dense_output</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># No interpolant needed</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Extract final state vector</span>

        <span class="c1">### --- Private Methods --- ###</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_solve_bidirectional_raw</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">t_0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">t_eval</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform bidirectional integration: backward from t_0, forward from t_0.</span>

<span class="sd">        Returns raw scipy OdeResult objects from both integrations, without</span>
<span class="sd">        concatenation. Concatenation is handled by EuclideanTrajectory.from_segments().</span>

<span class="sd">        This handles the case where flow is desired on an open interval I around</span>
<span class="sd">        t_0, e.g., I = (-1, 1) with t_0 = 0.</span>

<span class="sd">        Args:</span>
<span class="sd">            initial_state: x(t_0)</span>
<span class="sd">            t_0: Initial time (interior to t_eval range)</span>
<span class="sd">            t_eval: Full evaluation array</span>
<span class="sd">            method: Solver method</span>
<span class="sd">            dense_output: Whether to generate interpolant for each segment</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[Any, Any]: (sol_backward, sol_forward) raw scipy OdeResult objects</span>

<span class="sd">        NOTE: Each segment can have dense_output if requested. The trajectory</span>
<span class="sd">        will handle dispatching interpolation to the correct segment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># SPLIT EVALUATION ARRAY FOR BIDIRECTIONAL INTEGRATION</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># Split t_eval into backward and forward portions around t_0</span>
        <span class="c1"># </span>
        <span class="c1"># Key insight: We need BOTH segments to include t_0 to ensure they are TANGENT</span>
        <span class="c1"># (i.e., they share the boundary point) with no gap in the trajectory domain.</span>
        <span class="c1">#</span>
        <span class="c1"># Without this fix, we had a gap:</span>
        <span class="c1">#   Backward: [..., -0.01, -0.005]  (ends NEAR t_0 but not AT t_0)</span>
        <span class="c1">#   Forward:  [0.005, 0.01, ...]    (starts NEAR t_0 but not AT t_0)</span>
        <span class="c1">#   Gap: (-0.005, 0.005) where interpolation fails!</span>
        <span class="c1">#</span>
        <span class="c1"># With this fix, segments are tangent:</span>
        <span class="c1">#   Backward: [..., -0.01, -0.005, 0.0]  (ends AT t_0)</span>
        <span class="c1">#   Forward:  [0.0, 0.005, 0.01, ...]    (starts AT t_0)</span>
        <span class="c1">#   No gap: domains touch at t_0</span>

        <span class="n">t_eval_backward</span> <span class="o">=</span> <span class="n">t_eval</span><span class="p">[</span><span class="n">t_eval</span> <span class="o">&lt;</span> <span class="n">t_0</span><span class="p">]</span>   <span class="c1"># Points strictly before t_0</span>
        <span class="n">t_eval_forward</span> <span class="o">=</span> <span class="n">t_eval</span><span class="p">[</span><span class="n">t_eval</span> <span class="o">&gt;=</span> <span class="n">t_0</span><span class="p">]</span>   <span class="c1"># Points at or after t_0</span>

        <span class="c1"># ====================================================================</span>
        <span class="c1"># BACKWARD INTEGRATION: t_0 → min(t_eval)</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># Include t_0 in backward to ensure tangent domain with forward segment</span>
        <span class="c1"># This is CRITICAL for avoiding gaps in the trajectory domain</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_eval_backward</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Append t_0 to backward evaluation points</span>
            <span class="c1"># This ensures backward segment ends exactly at t_0</span>
            <span class="n">t_eval_backward_with_t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_eval_backward</span><span class="p">,</span> <span class="n">t_0</span><span class="p">)</span>
            <span class="n">sol_backward</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
                <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_eval_backward</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>  <span class="c1"># t_0 to minimum</span>
                <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval_backward_with_t0</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="c1"># Reverse for increasing order</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span>  <span class="c1"># Allow dense output for segment</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sol_backward</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># ====================================================================</span>
        <span class="c1"># FORWARD INTEGRATION: t_0 → max(t_eval)</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># Ensure t_0 is at the start to guarantee tangent domain</span>
        <span class="c1"># </span>
        <span class="c1"># Edge case: When t_eval = linspace(a, b, n), t_0 may or may not be</span>
        <span class="c1"># exactly in the array due to floating-point spacing.</span>
        <span class="c1">#</span>
        <span class="c1"># Example problematic case:</span>
        <span class="c1">#   t_eval = linspace(-2, 2, 400) might give:</span>
        <span class="c1">#   [..., -0.005, 0.005, ...] where 0.0 is MISSING!</span>
        <span class="c1">#   </span>
        <span class="c1"># Even if we filter t_eval[t_eval &gt;= t_0], we might get:</span>
        <span class="c1">#   t_eval_forward = [0.005, 0.01, ...] missing the exact t_0=0.0</span>
        <span class="c1">#</span>
        <span class="c1"># Solution: Explicitly prepend t_0 if not already present (within tolerance)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_eval_forward</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Check if t_0 is already the first point (within floating-point tolerance)</span>
            <span class="c1"># Using 1e-10 tolerance to handle numerical precision issues</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">t_eval_forward</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">t_0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">:</span>
                <span class="c1"># t_0 is NOT in t_eval_forward, prepend it explicitly</span>
                <span class="c1"># This ensures forward segment starts exactly at t_0</span>
                <span class="n">t_eval_forward_with_t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="n">t_0</span><span class="p">],</span> <span class="n">t_eval_forward</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># t_0 is already present, no modification needed</span>
                <span class="n">t_eval_forward_with_t0</span> <span class="o">=</span> <span class="n">t_eval_forward</span>

            <span class="n">sol_forward</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
                <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
                <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t_0</span><span class="p">,</span> <span class="n">t_eval_forward</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>  <span class="c1"># t_0 to maximum</span>
                <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval_forward_with_t0</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span>  <span class="c1"># Allow dense output for segment</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sol_forward</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Return raw solutions (let Trajectory handle merging)</span>
        <span class="k">return</span> <span class="n">sol_backward</span><span class="p">,</span> <span class="n">sol_forward</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="PyDynSys.core.euclidean.AutonomousEuclideanDS.vector_field" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vector_field</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Vector field defining the dynamical system.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.AutonomousEuclideanDS.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">vector_field</span><span class="p">,</span> <span class="n">phase_space</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize autonomous system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dimension</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Phase space dimension n</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vector_field</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="AutonomousVectorField = Callable[[NDArray[np.float64]], NDArray[np.float64]]

  
      module-attribute
   (PyDynSys.core.types.AutonomousVectorField)" href="../#PyDynSys.core.AutonomousVectorField">AutonomousVectorField</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function F(x) -&gt; dx/dt mapping R^n -&gt; R^n</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phase_space</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.phase_space.PhaseSpace


  
      dataclass
  " href="phase_space/#PyDynSys.core.euclidean.phase_space.PhaseSpace">PhaseSpace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Phase space X subset R^n (defaults to X = R^n)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If dimension &lt;= 0 or phase_space dimension mismatch</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/autonomous.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
    <span class="n">vector_field</span><span class="p">:</span> <span class="n">AutonomousVectorField</span><span class="p">,</span>
    <span class="n">phase_space</span><span class="p">:</span> <span class="n">PhaseSpace</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize autonomous system.</span>

<span class="sd">    Args:</span>
<span class="sd">        dimension (int): Phase space dimension n</span>
<span class="sd">        vector_field: Function F(x) -&gt; dx/dt mapping R^n -&gt; R^n</span>
<span class="sd">        phase_space: Phase space X subset R^n (defaults to X = R^n)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If dimension &lt;= 0 or phase_space dimension mismatch</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Enforce default: X = R^n with symbolic representation</span>
    <span class="k">if</span> <span class="n">phase_space</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">phase_space</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="o">.</span><span class="n">euclidean</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">phase_space</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_vector_field</span> <span class="o">=</span> <span class="n">vector_field</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.AutonomousEuclideanDS.evolve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evolve</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Single time-step evolution: estimate x(t_0 + dt) from x(t_0).</p>
<p>Convenience wrapper for rapid single-step integration without caching.
For repeated evaluations or bidirectional integration, use trajectory().</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>initial_state</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>State at time t_0</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial time</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step (must be positive)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ODE solver</p>
              </div>
            </td>
            <td>
                  <code>&#39;RK45&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>NDArray[np.float64]: Estimated state at t_0 + dt</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If state dimension incorrect or dt ≤ 0</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>NOTE: For backwards evolution or flow on intervals around t_0,
use trajectory() instead which supports bidirectional integration.</p>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/autonomous.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evolve</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;RK45&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single time-step evolution: estimate x(t_0 + dt) from x(t_0).</span>

<span class="sd">    Convenience wrapper for rapid single-step integration without caching.</span>
<span class="sd">    For repeated evaluations or bidirectional integration, use trajectory().</span>

<span class="sd">    Args:</span>
<span class="sd">        initial_state: State at time t_0</span>
<span class="sd">        t0: Initial time</span>
<span class="sd">        dt: Time step (must be positive)</span>
<span class="sd">        method: ODE solver</span>

<span class="sd">    Returns:</span>
<span class="sd">        NDArray[np.float64]: Estimated state at t_0 + dt</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If state dimension incorrect or dt ≤ 0</span>

<span class="sd">    NOTE: For backwards evolution or flow on intervals around t_0,</span>
<span class="sd">    use trajectory() instead which supports bidirectional integration.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_time_step</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

    <span class="c1"># Single-step integration without caching</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
        <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
        <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="p">),</span>
        <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
        <span class="n">t_eval</span><span class="o">=</span><span class="p">[</span><span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="p">],</span>
        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="n">dense_output</span><span class="o">=</span><span class="kc">False</span>  <span class="c1"># No interpolant needed</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Extract final state vector</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.AutonomousEuclideanDS.trajectory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trajectory</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">t_eval</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Solve initial value problem: dx/dt = F(x), x(t_0) = x_0 over interval I.</p>
<p>Supports bidirectional integration: if t_span = (t_0, t_end) where 
t_0 is interior to the t_eval range, performs:
- Backward integration: t_0 → min(t_eval)
- Forward integration: t_0 → max(t_eval)
Then concatenates results.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>initial_state</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial condition x(t_0) ∈ R^n</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_span</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Effective integration bounds (t_start, t_end)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_eval</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Evaluation points (may span both sides of an interior t_0)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ODE solver (default 'RK45' = 5th order Runge-Kutta w/ adaptive step size)</p>
              </div>
            </td>
            <td>
                  <code>&#39;RK45&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dense_output</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, returns continuous interpolant sol(t)
-&gt; NOTE: I am yet to see a use case where not true is useful, and it comes 
at a minimal computational cost.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>EuclideanTrajectory</code></td>            <td>
                  <code><span title="PyDynSys.core.euclidean.trajectory.EuclideanTrajectory">EuclideanTrajectory</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Trajectory object with attributes:
- t: Evaluation times (property, concatenated from segments)
- y: States at each time (property, concatenated from segments)
- segments: List of trajectory segments
- interpolate(t): Method for continuous evaluation at time t
- domains: List of domain intervals for each segment</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If state dimension incorrect, t_span invalid, 
       or t_eval points outside valid range</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="implementation-notes" open>
  <summary>Implementation Notes</summary>
  <ul>
<li>Solutions cached by (initial_state, t_span, t_eval, method)</li>
<li>Integrator uses λ(t, x): self.vector_field(x) (ignores t)</li>
<li>Bidirectional: if t_0 interior to [min(t_eval), max(t_eval)]</li>
<li>No existence/uniqueness checks performed (TODO: future)</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/autonomous.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trajectory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">t_eval</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;RK45&#39;</span><span class="p">,</span>
    <span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EuclideanTrajectory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve initial value problem: dx/dt = F(x), x(t_0) = x_0 over interval I.</span>

<span class="sd">    Supports bidirectional integration: if t_span = (t_0, t_end) where </span>
<span class="sd">    t_0 is interior to the t_eval range, performs:</span>
<span class="sd">    - Backward integration: t_0 → min(t_eval)</span>
<span class="sd">    - Forward integration: t_0 → max(t_eval)</span>
<span class="sd">    Then concatenates results.</span>

<span class="sd">    Args:</span>
<span class="sd">        initial_state: Initial condition x(t_0) ∈ R^n</span>
<span class="sd">        t_span: Effective integration bounds (t_start, t_end)</span>
<span class="sd">        t_eval: Evaluation points (may span both sides of an interior t_0)</span>
<span class="sd">        method: ODE solver (default &#39;RK45&#39; = 5th order Runge-Kutta w/ adaptive step size)</span>
<span class="sd">        dense_output: If True, returns continuous interpolant sol(t)</span>
<span class="sd">            -&gt; NOTE: I am yet to see a use case where not true is useful, and it comes </span>
<span class="sd">            at a minimal computational cost.</span>

<span class="sd">    Returns:</span>
<span class="sd">        EuclideanTrajectory: Trajectory object with attributes:</span>
<span class="sd">            - t: Evaluation times (property, concatenated from segments)</span>
<span class="sd">            - y: States at each time (property, concatenated from segments)</span>
<span class="sd">            - segments: List of trajectory segments</span>
<span class="sd">            - interpolate(t): Method for continuous evaluation at time t</span>
<span class="sd">            - domains: List of domain intervals for each segment</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If state dimension incorrect, t_span invalid, </span>
<span class="sd">                   or t_eval points outside valid range</span>

<span class="sd">    Implementation Notes:</span>
<span class="sd">        - Solutions cached by (initial_state, t_span, t_eval, method)</span>
<span class="sd">        - Integrator uses λ(t, x): self.vector_field(x) (ignores t)</span>
<span class="sd">        - Bidirectional: if t_0 interior to [min(t_eval), max(t_eval)]</span>
<span class="sd">        - No existence/uniqueness checks performed (TODO: future)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_time_span</span><span class="p">(</span><span class="n">t_span</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_t_eval</span><span class="p">(</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">t_span</span><span class="p">)</span>

    <span class="c1"># ====================================================================</span>
    <span class="c1"># CACHING STRATEGY</span>
    <span class="c1"># ====================================================================</span>
    <span class="c1"># Check cache (removed method field - trajectories can be multi-method)</span>
    <span class="c1"># </span>
    <span class="c1"># Cache key includes: (x_0, t_0, t_eval) but NOT method</span>
    <span class="c1"># This allows cache hits even with different methods, which is reasonable because:</span>
    <span class="c1">#   1. Different methods solve the same IVP (should give similar results)</span>
    <span class="c1">#   2. Multi-method trajectories are valid (bidirectional with different methods)</span>
    <span class="c1">#   3. Simpler cache logic (no need to track method combinations)</span>
    <span class="c1">#</span>
    <span class="c1"># For autonomous systems, t_0 doesn&#39;t affect trajectory shape (time-translation</span>
    <span class="c1"># invariant), but we store it for consistency with non-autonomous systems and</span>
    <span class="c1"># potential future optimizations (e.g., recognizing time-shifted duplicates).</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="n">TrajectoryCacheKey</span><span class="p">(</span>
        <span class="n">initial_conditions</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">initial_state</span><span class="p">),</span>
        <span class="n">initial_time</span><span class="o">=</span><span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>  <span class="c1"># Store t_0 (typically 0 for autonomous, but can vary)</span>
        <span class="n">t_eval_tuple</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Cache hit: Return previously computed trajectory (may have been computed with different method!)</span>
    <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>

    <span class="c1"># ====================================================================</span>
    <span class="c1"># BIDIRECTIONAL INTEGRATION DETECTION</span>
    <span class="c1"># ====================================================================</span>
    <span class="c1"># Determine if bidirectional integration needed</span>
    <span class="c1"># </span>
    <span class="c1"># Standard (unidirectional) integration: t_0 at boundary of t_eval range</span>
    <span class="c1">#   Example: t_0=0, t_eval=[0, 0.1, 0.2, ..., 10]</span>
    <span class="c1">#   Flow computed in ONE direction: forward from t_0 to max(t_eval)</span>
    <span class="c1">#</span>
    <span class="c1"># Bidirectional integration: t_0 INTERIOR to t_eval range</span>
    <span class="c1">#   Example: t_0=0, t_eval=[-5, -4, ..., -0.1, 0, 0.1, ..., 4, 5]</span>
    <span class="c1">#   Flow computed in TWO directions: </span>
    <span class="c1">#     - Backward from t_0 to min(t_eval)</span>
    <span class="c1">#     - Forward from t_0 to max(t_eval)</span>
    <span class="c1">#   This is useful for studying orbits, limit cycles, and phase portraits</span>
    <span class="c1">#   where we want to see the trajectory evolve both forward and backward in time</span>
    <span class="c1">#</span>
    <span class="c1"># NOTE: scipy.solve_ivp does NOT support bidirectional integration natively,</span>
    <span class="c1"># so we manually split into two IVPs and merge the resulting segments.</span>

    <span class="n">t_0</span> <span class="o">=</span> <span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Assume first element is initial time</span>
    <span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t_eval</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span>

    <span class="c1"># Check if we need backward integration (t_0 above minimum)</span>
    <span class="n">needs_backward</span> <span class="o">=</span> <span class="n">t_0</span> <span class="o">&gt;</span> <span class="n">t_min</span>
    <span class="c1"># Check if we need forward integration (t_0 below maximum)</span>
    <span class="n">needs_forward</span> <span class="o">=</span> <span class="n">t_0</span> <span class="o">&lt;</span> <span class="n">t_max</span>

    <span class="k">if</span> <span class="n">needs_backward</span> <span class="ow">and</span> <span class="n">needs_forward</span><span class="p">:</span>
        <span class="c1"># BIDIRECTIONAL CASE: t_0 is interior to [t_min, t_max]</span>
        <span class="c1"># Bidirectional case: integrate backwards and forwards</span>
        <span class="c1"># Create two segments and let Trajectory handle tangent domain at t_0</span>
        <span class="c1"># </span>
        <span class="c1"># DESIGN DECISION: Why not manually concatenate like before?</span>
        <span class="c1"># ----------------------------------------------------------</span>
        <span class="c1"># Old approach (removed): Manually concatenate t and y arrays, return single</span>
        <span class="c1">#   SciPyIvpSolution with sol=None (no interpolant possible)</span>
        <span class="c1"># </span>
        <span class="c1"># New approach: Create two segments, let EuclideanTrajectory.from_segments()</span>
        <span class="c1">#   handle merging. Benefits:</span>
        <span class="c1">#   1. Preserves BOTH interpolants (one for each segment)</span>
        <span class="c1">#   2. Allows seamless interpolation via trajectory.interpolate(t) dispatch</span>
        <span class="c1">#   3. Consistent with manual trajectory composition workflow</span>
        <span class="c1">#   4. Cleaner separation of concerns (merging logic in one place)</span>
        <span class="n">sol_backward_raw</span><span class="p">,</span> <span class="n">sol_forward_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_bidirectional_raw</span><span class="p">(</span>
            <span class="n">initial_state</span><span class="p">,</span> <span class="n">t_0</span><span class="p">,</span> <span class="n">t_eval</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">dense_output</span>
        <span class="p">)</span>

        <span class="c1"># Wrap raw scipy solutions in segments</span>
        <span class="c1"># Each segment preserves its interpolant if dense_output=True</span>
        <span class="n">seg_backward</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
            <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">sol_backward_raw</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span>
        <span class="p">)</span>
        <span class="n">seg_forward</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
            <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">sol_forward_raw</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span>
        <span class="p">)</span>

        <span class="c1"># Merge via trajectory (handles tangent domain automatically)</span>
        <span class="c1"># The segments share t_0 → average merge policy merges the shared point</span>
        <span class="c1"># Result: Single trajectory with 2 segments, tangent at t_0</span>
        <span class="n">trajectory</span> <span class="o">=</span> <span class="n">EuclideanTrajectory</span><span class="o">.</span><span class="n">from_segments</span><span class="p">([</span><span class="n">seg_backward</span><span class="p">,</span> <span class="n">seg_forward</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># UNIDIRECTIONAL CASE: Standard forward or backward integration</span>
        <span class="c1"># t_0 is at boundary of t_eval range (not interior)</span>
        <span class="c1"># </span>
        <span class="c1"># Even though this is a single scipy solve_ivp call, we STILL wrap it</span>
        <span class="c1"># in EuclideanTrajectory (with one segment) for API consistency.</span>
        <span class="c1"># </span>
        <span class="c1"># WHY? Uniform return type simplifies user code:</span>
        <span class="c1">#   result = sys.trajectory(...)  # Always get EuclideanTrajectory</span>
        <span class="c1">#   result.interpolate(t)          # Always works the same way</span>
        <span class="c1">#   result.segments                # Always accessible (just 1 segment here)</span>
        <span class="c1"># </span>
        <span class="c1"># User doesn&#39;t need to check &quot;is this bidirectional or unidirectional?&quot;</span>
        <span class="n">solution_raw</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
            <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>  <span class="c1"># Ignore time parameter (autonomous)</span>
            <span class="n">t_span</span><span class="o">=</span><span class="n">t_span</span><span class="p">,</span>
            <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
            <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span>
        <span class="p">)</span>

        <span class="c1"># Wrap scipy solution in segment, then wrap segment in trajectory</span>
        <span class="c1"># Result: EuclideanTrajectory with 1 segment</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
            <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">solution_raw</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span>
        <span class="p">)</span>
        <span class="n">trajectory</span> <span class="o">=</span> <span class="n">EuclideanTrajectory</span><span class="o">.</span><span class="n">from_segments</span><span class="p">([</span><span class="n">segment</span><span class="p">])</span>

    <span class="c1"># Cache and return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">trajectory</span>
    <span class="k">return</span> <span class="n">trajectory</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="PyDynSys.core.euclidean.EuclideanDS" class="doc doc-heading">
            <code>EuclideanDS</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="abc.ABC">ABC</span></code></p>


        <p>Abstract base class for Euclidean dynamical systems.</p>
<p>Represents systems of first-order ODEs in R^n of form:
    dx/dt = F(x)       (autonomous)
    dx/dt = F(x, t)    (non-autonomous)</p>
<p>Provides:
- Shared infrastructure (dimension, solution caching, validation)
- Abstract interface (subclasses must implement vector_field)
- Factory method (from_symbolic auto-detects system type)
- Common utilities (distance, volume, trajectory solving)</p>
<p>NOTE: This class is abstract. Instantiate AutonomousEuclideanDS or
NonAutonomousEuclideanDS directly, or use from_symbolic factory.</p>








              <details class="quote">
                <summary>Source code in <code>src/PyDynSys/core/euclidean/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">EuclideanDS</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract base class for Euclidean dynamical systems.</span>

<span class="sd">    Represents systems of first-order ODEs in R^n of form:</span>
<span class="sd">        dx/dt = F(x)       (autonomous)</span>
<span class="sd">        dx/dt = F(x, t)    (non-autonomous)</span>

<span class="sd">    Provides:</span>
<span class="sd">    - Shared infrastructure (dimension, solution caching, validation)</span>
<span class="sd">    - Abstract interface (subclasses must implement vector_field)</span>
<span class="sd">    - Factory method (from_symbolic auto-detects system type)</span>
<span class="sd">    - Common utilities (distance, volume, trajectory solving)</span>

<span class="sd">    NOTE: This class is abstract. Instantiate AutonomousEuclideanDS or</span>
<span class="sd">    NonAutonomousEuclideanDS directly, or use from_symbolic factory.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">phase_space</span><span class="p">:</span> <span class="n">PhaseSpace</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize Euclidean dynamical system.</span>

<span class="sd">        Args:</span>
<span class="sd">            dimension (int): Phase space dimension n (must be positive integer)</span>
<span class="sd">                -&gt; Not a dimension in the linear subspace sense of the term, just #state_components                </span>
<span class="sd">            phase_space (PhaseSpace): Phase space X subset of R^n</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If dimension ≤ 0 or phase_space dimension mismatch</span>

<span class="sd">        NOTE: This constructor is NEVER called directly by users (abstract class).</span>
<span class="sd">        It&#39;s invoked via super().__init__() from subclasses.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validation</span>
        <span class="k">if</span> <span class="n">dimension</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Phase space dimension must be positive, got </span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">phase_space</span><span class="o">.</span><span class="n">dimension</span> <span class="o">!=</span> <span class="n">dimension</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Phase space dimension (</span><span class="si">{</span><span class="n">phase_space</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">) must match &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;system dimension (</span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">=</span> <span class="n">dimension</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phase_space</span> <span class="o">=</span> <span class="n">phase_space</span>
        <span class="c1"># Cache now stores EuclideanTrajectory objects, will be updated in subclasses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">TrajectoryCacheKey</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>


    <span class="c1"># ========================================================================</span>
    <span class="c1"># Factory Method - Auto-detects Autonomous vs Non-Autonomous</span>
    <span class="c1"># ========================================================================</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_symbolic</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">equations</span><span class="p">:</span> <span class="n">SymbolicODE</span><span class="p">,</span>
        <span class="n">variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">syp</span><span class="o">.</span><span class="n">Function</span><span class="p">],</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">SystemParameters</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">phase_space</span><span class="p">:</span> <span class="n">PhaseSpace</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">time_horizon</span><span class="p">:</span> <span class="n">TimeHorizon</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EuclideanDS&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory method: construct system instance from symbolic equations.</span>

<span class="sd">        Auto-detects whether system is autonomous and returns appropriate</span>
<span class="sd">        subclass instance (AutonomousEuclideanDS or NonAutonomousEuclideanDS).</span>

<span class="sd">        Args:</span>
<span class="sd">            equations: Symbolic ODE in form [d(x_i)/dt - F_i(x, t), ...]</span>
<span class="sd">            variables: Dependent variables as SymPy Function objects</span>
<span class="sd">            parameters: Optional parameter substitution dict</span>
<span class="sd">            phase_space: Phase space X subset R^n (defaults to X = R^n)</span>
<span class="sd">            time_horizon: Time horizon T subset R (only used for non-autonomous, defaults to T = R)</span>

<span class="sd">        Returns:</span>
<span class="sd">            AutonomousEuclideanDS if partial(F, t) = 0, else NonAutonomousEuclideanDS</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If system is not first-order</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; t = syp.symbols(&#39;t&#39;)</span>
<span class="sd">            &gt;&gt;&gt; x, y = syp.symbols(&#39;x y&#39;, cls=syp.Function)</span>
<span class="sd">            &gt;&gt;&gt; x, y = x(t), y(t)</span>
<span class="sd">            &gt;&gt;&gt; # Autonomous system</span>
<span class="sd">            &gt;&gt;&gt; eqs = [syp.diff(x, t) - y, syp.diff(y, t) + x]</span>
<span class="sd">            &gt;&gt;&gt; sys = EuclideanDS.from_symbolic(eqs, [x, y])</span>
<span class="sd">            &gt;&gt;&gt; type(sys).__name__</span>
<span class="sd">            &#39;AutonomousEuclideanDS&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..sym_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">SymbolicSystemBuilder</span>

        <span class="c1"># Build vector field and detect system type</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">SymbolicSystemBuilder</span><span class="o">.</span><span class="n">build_vector_field</span><span class="p">(</span>
            <span class="n">equations</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span>
        <span class="p">)</span>

        <span class="c1"># Create default phase space if not provided</span>
        <span class="k">if</span> <span class="n">phase_space</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">phase_space</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="o">.</span><span class="n">euclidean</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span>

        <span class="c1"># Dispatch to appropriate subclass</span>
        <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_autonomous</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.autonomous</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutonomousEuclideanDS</span>
            <span class="k">return</span> <span class="n">AutonomousEuclideanDS</span><span class="p">(</span>
                <span class="n">dimension</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span>
                <span class="n">vector_field</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">vector_field</span><span class="p">,</span>
                <span class="n">phase_space</span><span class="o">=</span><span class="n">phase_space</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.non_autonomous</span><span class="w"> </span><span class="kn">import</span> <span class="n">NonAutonomousEuclideanDS</span>
            <span class="c1"># Create default time horizon if not provided</span>
            <span class="k">if</span> <span class="n">time_horizon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">time_horizon</span> <span class="o">=</span> <span class="n">TimeHorizon</span><span class="o">.</span><span class="n">real_line</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">NonAutonomousEuclideanDS</span><span class="p">(</span>
                <span class="n">dimension</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span>
                <span class="n">vector_field</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">vector_field</span><span class="p">,</span>
                <span class="n">phase_space</span><span class="o">=</span><span class="n">phase_space</span><span class="p">,</span>
                <span class="n">time_horizon</span><span class="o">=</span><span class="n">time_horizon</span>
            <span class="p">)</span>


    <span class="c1"># ========================================================================</span>
    <span class="c1"># Abstract Interface - Subclasses Must Implement</span>
    <span class="c1"># ========================================================================</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">trajectory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">t_eval</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">t0</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;RK45&#39;</span><span class="p">,</span>
        <span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EuclideanTrajectory</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vector_field</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">AutonomousVectorField</span><span class="p">,</span> <span class="n">NonAutonomousVectorField</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vector field defining the dynamical system.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Vector field function (signature depends on subclass)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>


    <span class="c1"># ========================================================================</span>
    <span class="c1"># Validation</span>
    <span class="c1"># ========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate state vector dimension and phase space membership.</span>

<span class="sd">        Args:</span>
<span class="sd">            state: State vector to validate</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If state.shape != (dimension,) or state ∉ X</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;State vector has incorrect dimension: &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;expected (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">,), got </span><span class="si">{</span><span class="n">state</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Check phase space membership</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">phase_space</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;State </span><span class="si">{</span><span class="n">state</span><span class="si">}</span><span class="s2"> is not in phase space X. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Phase space constraints violated.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_time_span</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate time span for integration.</span>

<span class="sd">        Allows:</span>
<span class="sd">        - Forward integration: t_start &lt; t_end</span>
<span class="sd">        - Backward integration: t_start &gt; t_end</span>
<span class="sd">        - Bidirectional: t_start interior to t_eval range (checked separately)</span>

<span class="sd">        Forbids:</span>
<span class="sd">        - Zero-length intervals: t_start == t_end</span>

<span class="sd">        Args:</span>
<span class="sd">            t_span: (t_start, t_end) interval</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If t_start == t_end</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">=</span> <span class="n">t_span</span>
        <span class="k">if</span> <span class="n">t_start</span> <span class="o">==</span> <span class="n">t_end</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Time span must have nonzero length, got t_span = </span><span class="si">{</span><span class="n">t_span</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_t_eval</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">t_eval</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> 
        <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate evaluation time points.</span>

<span class="sd">        For unidirectional integration: t_eval must be within [min(t_span), max(t_span)]</span>
<span class="sd">        For bidirectional: t_span[0] is t_0, t_eval can span around it</span>

<span class="sd">        Args:</span>
<span class="sd">            t_eval: Time points for solution evaluation</span>
<span class="sd">            t_span: Integration interval</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If t_eval points outside valid range for unidirectional integration</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">=</span> <span class="n">t_span</span>
        <span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span><span class="p">)</span>

        <span class="c1"># Check if bidirectional pattern: t_start is interior to t_eval</span>
        <span class="n">t_eval_min</span><span class="p">,</span> <span class="n">t_eval_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t_eval</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span>
        <span class="n">is_bidirectional</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_eval_min</span> <span class="o">&lt;</span> <span class="n">t_start</span> <span class="o">&lt;</span> <span class="n">t_eval_max</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_bidirectional</span><span class="p">:</span>
            <span class="c1"># Standard unidirectional: t_eval must be within t_span bounds</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">t_eval</span> <span class="o">&lt;</span> <span class="n">t_min</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">t_eval</span> <span class="o">&gt;</span> <span class="n">t_max</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;All t_eval points must be in [</span><span class="si">{</span><span class="n">t_min</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">t_max</span><span class="si">}</span><span class="s2">], &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;got range [</span><span class="si">{</span><span class="n">t_eval_min</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">t_eval_max</span><span class="si">}</span><span class="s2">]&quot;</span>
                <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_time_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate time step for single evolution.</span>

<span class="sd">        Args:</span>
<span class="sd">            dt: Time step</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If dt &lt;= 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dt</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time step must be positive, got dt = </span><span class="si">{</span><span class="n">dt</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="c1"># ========================================================================</span>
    <span class="c1"># Phase Space Geometry</span>
    <span class="c1"># ========================================================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">phase_space_distance</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">x1</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> 
        <span class="n">x2</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Euclidean distance between two phase space points.</span>

<span class="sd">        Computes L2 norm: ||x1 - x2||_2 = sqrt(Σ(x1_i - x2_i)²)</span>

<span class="sd">        Args:</span>
<span class="sd">            x1, x2: Points in phase space R^n</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Euclidean distance</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If x1 or x2 have incorrect dimension</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">phase_space_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Estimate volume of point cloud in phase space.</span>

<span class="sd">        Uses ConvexHull if available, falls back to bounding box volume.</span>
<span class="sd">        Returns np.inf if phase space is unbounded and points span infinite extent.</span>

<span class="sd">        Args:</span>
<span class="sd">            points: Array of shape (n_points, dimension)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.float64: Estimated volume. Returns np.float64(np.inf) if phase </span>
<span class="sd">                        space is unbounded and points span infinite extent.</span>
<span class="sd">                        Returns 0.0 if insufficient points for hull.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If points.shape[1] != dimension</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Points must have dimension </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;got shape </span><span class="si">{</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># Insufficient points for non-degenerate hull</span>

        <span class="c1"># Check for infinite extent</span>
        <span class="n">extents</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">extents</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConvexHull</span>
            <span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">hull</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
            <span class="c1"># Fallback: bounding box volume</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">extents</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="PyDynSys.core.euclidean.EuclideanDS.vector_field" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vector_field</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Vector field defining the dynamical system.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="AutonomousVectorField = Callable[[NDArray[np.float64]], NDArray[np.float64]]

  
      module-attribute
   (PyDynSys.core.types.AutonomousVectorField)" href="../#PyDynSys.core.AutonomousVectorField">AutonomousVectorField</a>, <a class="autorefs autorefs-internal" title="NonAutonomousVectorField = Callable[[NDArray[np.float64], float], NDArray[np.float64]]

  
      module-attribute
   (PyDynSys.core.types.NonAutonomousVectorField)" href="../#PyDynSys.core.NonAutonomousVectorField">NonAutonomousVectorField</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Vector field function (signature depends on subclass)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.EuclideanDS.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">phase_space</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize Euclidean dynamical system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dimension</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Phase space dimension n (must be positive integer)
-&gt; Not a dimension in the linear subspace sense of the term, just #state_components                </p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phase_space</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.phase_space.PhaseSpace


  
      dataclass
  " href="phase_space/#PyDynSys.core.euclidean.phase_space.PhaseSpace">PhaseSpace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Phase space X subset of R^n</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If dimension ≤ 0 or phase_space dimension mismatch</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>
        <p>NOTE: This constructor is NEVER called directly by users (abstract class).
It's invoked via super().<strong>init</strong>() from subclasses.</p>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">phase_space</span><span class="p">:</span> <span class="n">PhaseSpace</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize Euclidean dynamical system.</span>

<span class="sd">    Args:</span>
<span class="sd">        dimension (int): Phase space dimension n (must be positive integer)</span>
<span class="sd">            -&gt; Not a dimension in the linear subspace sense of the term, just #state_components                </span>
<span class="sd">        phase_space (PhaseSpace): Phase space X subset of R^n</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If dimension ≤ 0 or phase_space dimension mismatch</span>

<span class="sd">    NOTE: This constructor is NEVER called directly by users (abstract class).</span>
<span class="sd">    It&#39;s invoked via super().__init__() from subclasses.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validation</span>
    <span class="k">if</span> <span class="n">dimension</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Phase space dimension must be positive, got </span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">phase_space</span><span class="o">.</span><span class="n">dimension</span> <span class="o">!=</span> <span class="n">dimension</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Phase space dimension (</span><span class="si">{</span><span class="n">phase_space</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">) must match &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;system dimension (</span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">=</span> <span class="n">dimension</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">phase_space</span> <span class="o">=</span> <span class="n">phase_space</span>
    <span class="c1"># Cache now stores EuclideanTrajectory objects, will be updated in subclasses</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">TrajectoryCacheKey</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.EuclideanDS.from_symbolic" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_symbolic</span><span class="p">(</span><span class="n">equations</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">phase_space</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_horizon</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Factory method: construct system instance from symbolic equations.</p>
<p>Auto-detects whether system is autonomous and returns appropriate
subclass instance (AutonomousEuclideanDS or NonAutonomousEuclideanDS).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>equations</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SymbolicODE = Union[List[syp.Expr], syp.Expr, str, List[str]]

  
      module-attribute
   (PyDynSys.core.types.SymbolicODE)" href="../#PyDynSys.core.SymbolicODE">SymbolicODE</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Symbolic ODE in form [d(x_i)/dt - F_i(x, t), ...]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>variables</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="sympy.Function">Function</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dependent variables as SymPy Function objects</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SystemParameters = Union[Dict[str, float], Dict[syp.Symbol, float]]

  
      module-attribute
   (PyDynSys.core.types.SystemParameters)" href="../#PyDynSys.core.SystemParameters">SystemParameters</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional parameter substitution dict</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phase_space</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.phase_space.PhaseSpace


  
      dataclass
  " href="phase_space/#PyDynSys.core.euclidean.phase_space.PhaseSpace">PhaseSpace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Phase space X subset R^n (defaults to X = R^n)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_horizon</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.time_horizon.TimeHorizon


  
      dataclass
  " href="time_horizon/#PyDynSys.core.euclidean.time_horizon.TimeHorizon">TimeHorizon</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time horizon T subset R (only used for non-autonomous, defaults to T = R)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="EuclideanDS (PyDynSys.core.euclidean.base.EuclideanDS)" href="#PyDynSys.core.euclidean.EuclideanDS">EuclideanDS</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>AutonomousEuclideanDS if partial(F, t) = 0, else NonAutonomousEuclideanDS</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If system is not first-order</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>t = syp.symbols('t')
x, y = syp.symbols('x y', cls=syp.Function)
x, y = x(t), y(t)</p>
<h5 id="PyDynSys.core.euclidean.EuclideanDS.from_symbolic--autonomous-system">Autonomous system</h5>
<p>eqs = [syp.diff(x, t) - y, syp.diff(y, t) + x]
sys = EuclideanDS.from_symbolic(eqs, [x, y])
type(sys).<strong>name</strong>
'AutonomousEuclideanDS'</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_symbolic</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">equations</span><span class="p">:</span> <span class="n">SymbolicODE</span><span class="p">,</span>
    <span class="n">variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">syp</span><span class="o">.</span><span class="n">Function</span><span class="p">],</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">SystemParameters</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">phase_space</span><span class="p">:</span> <span class="n">PhaseSpace</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">time_horizon</span><span class="p">:</span> <span class="n">TimeHorizon</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;EuclideanDS&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory method: construct system instance from symbolic equations.</span>

<span class="sd">    Auto-detects whether system is autonomous and returns appropriate</span>
<span class="sd">    subclass instance (AutonomousEuclideanDS or NonAutonomousEuclideanDS).</span>

<span class="sd">    Args:</span>
<span class="sd">        equations: Symbolic ODE in form [d(x_i)/dt - F_i(x, t), ...]</span>
<span class="sd">        variables: Dependent variables as SymPy Function objects</span>
<span class="sd">        parameters: Optional parameter substitution dict</span>
<span class="sd">        phase_space: Phase space X subset R^n (defaults to X = R^n)</span>
<span class="sd">        time_horizon: Time horizon T subset R (only used for non-autonomous, defaults to T = R)</span>

<span class="sd">    Returns:</span>
<span class="sd">        AutonomousEuclideanDS if partial(F, t) = 0, else NonAutonomousEuclideanDS</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If system is not first-order</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; t = syp.symbols(&#39;t&#39;)</span>
<span class="sd">        &gt;&gt;&gt; x, y = syp.symbols(&#39;x y&#39;, cls=syp.Function)</span>
<span class="sd">        &gt;&gt;&gt; x, y = x(t), y(t)</span>
<span class="sd">        &gt;&gt;&gt; # Autonomous system</span>
<span class="sd">        &gt;&gt;&gt; eqs = [syp.diff(x, t) - y, syp.diff(y, t) + x]</span>
<span class="sd">        &gt;&gt;&gt; sys = EuclideanDS.from_symbolic(eqs, [x, y])</span>
<span class="sd">        &gt;&gt;&gt; type(sys).__name__</span>
<span class="sd">        &#39;AutonomousEuclideanDS&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">..sym_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">SymbolicSystemBuilder</span>

    <span class="c1"># Build vector field and detect system type</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">SymbolicSystemBuilder</span><span class="o">.</span><span class="n">build_vector_field</span><span class="p">(</span>
        <span class="n">equations</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">parameters</span>
    <span class="p">)</span>

    <span class="c1"># Create default phase space if not provided</span>
    <span class="k">if</span> <span class="n">phase_space</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">phase_space</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="o">.</span><span class="n">euclidean</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">dimension</span><span class="p">)</span>

    <span class="c1"># Dispatch to appropriate subclass</span>
    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">is_autonomous</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.autonomous</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutonomousEuclideanDS</span>
        <span class="k">return</span> <span class="n">AutonomousEuclideanDS</span><span class="p">(</span>
            <span class="n">dimension</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span>
            <span class="n">vector_field</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">vector_field</span><span class="p">,</span>
            <span class="n">phase_space</span><span class="o">=</span><span class="n">phase_space</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.non_autonomous</span><span class="w"> </span><span class="kn">import</span> <span class="n">NonAutonomousEuclideanDS</span>
        <span class="c1"># Create default time horizon if not provided</span>
        <span class="k">if</span> <span class="n">time_horizon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">time_horizon</span> <span class="o">=</span> <span class="n">TimeHorizon</span><span class="o">.</span><span class="n">real_line</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">NonAutonomousEuclideanDS</span><span class="p">(</span>
            <span class="n">dimension</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span>
            <span class="n">vector_field</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">vector_field</span><span class="p">,</span>
            <span class="n">phase_space</span><span class="o">=</span><span class="n">phase_space</span><span class="p">,</span>
            <span class="n">time_horizon</span><span class="o">=</span><span class="n">time_horizon</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.EuclideanDS.phase_space_distance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">phase_space_distance</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Euclidean distance between two phase space points.</p>
<p>Computes L2 norm: ||x1 - x2||_2 = sqrt(Σ(x1_i - x2_i)²)</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x1, x2</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Points in phase space R^n</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Euclidean distance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If x1 or x2 have incorrect dimension</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">phase_space_distance</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">x1</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> 
    <span class="n">x2</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Euclidean distance between two phase space points.</span>

<span class="sd">    Computes L2 norm: ||x1 - x2||_2 = sqrt(Σ(x1_i - x2_i)²)</span>

<span class="sd">    Args:</span>
<span class="sd">        x1, x2: Points in phase space R^n</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Euclidean distance</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If x1 or x2 have incorrect dimension</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.EuclideanDS.phase_space_volume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">phase_space_volume</span><span class="p">(</span><span class="n">points</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Estimate volume of point cloud in phase space.</p>
<p>Uses ConvexHull if available, falls back to bounding box volume.
Returns np.inf if phase space is unbounded and points span infinite extent.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>points</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of shape (n_points, dimension)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.float64">float64</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.float64: Estimated volume. Returns np.float64(np.inf) if phase 
        space is unbounded and points span infinite extent.
        Returns 0.0 if insufficient points for hull.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If points.shape[1] != dimension</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">phase_space_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Estimate volume of point cloud in phase space.</span>

<span class="sd">    Uses ConvexHull if available, falls back to bounding box volume.</span>
<span class="sd">    Returns np.inf if phase space is unbounded and points span infinite extent.</span>

<span class="sd">    Args:</span>
<span class="sd">        points: Array of shape (n_points, dimension)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.float64: Estimated volume. Returns np.float64(np.inf) if phase </span>
<span class="sd">                    space is unbounded and points span infinite extent.</span>
<span class="sd">                    Returns 0.0 if insufficient points for hull.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If points.shape[1] != dimension</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Points must have dimension </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;got shape </span><span class="si">{</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>  <span class="c1"># Insufficient points for non-degenerate hull</span>

    <span class="c1"># Check for infinite extent</span>
    <span class="n">extents</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">extents</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.spatial</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConvexHull</span>
        <span class="n">hull</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">hull</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="c1"># Fallback: bounding box volume</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">extents</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="PyDynSys.core.euclidean.NonAutonomousEuclideanDS" class="doc doc-heading">
            <code>NonAutonomousEuclideanDS</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="EuclideanDS (PyDynSys.core.euclidean.base.EuclideanDS)" href="#PyDynSys.core.euclidean.EuclideanDS">EuclideanDS</a></code></p>


        <p>Non-autonomous Euclidean dynamical system.</p>
<p>Systems where dx/dt = F(x, t) with F: R^n x R → R^n explicitly
time-dependent. Equivalently, PartialDerivative(F, t) nonzero at some (x, t).</p>
<p>Mathematical Properties:
- Flow phi_t(x, t_0) depends on initial time t_0
- Can be autonomized by augmenting state: y = (x, t), dy/dt = (F(x,t), 1)
- Useful for periodically forced systems, time-varying parameters</p>
<p>NOTE: All non autonomous systems can be autonomized by augmenting state: y = (x, t), 
dy/dt = (F(x,t), 1). However, this can alter topological properties and is not always 
desirable, hence our support for non-autonomous systems.</p>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<h4 id="PyDynSys.core.euclidean.NonAutonomousEuclideanDS--driven-harmonic-oscillator-x-x-sint">Driven harmonic oscillator: x'' + x = sin(t)</h4>
<p>def driven_oscillator(x, t):
...     return np.array([x[1], -x[0] + np.sin(t)])
phase_space = PhaseSpace.euclidean(2)
time_horizon = TimeHorizon.real_line()
sys = NonAutonomousEuclideanDS(
...     dimension=2, 
...     vector_field=driven_oscillator,
...     phase_space=phase_space,
...     time_horizon=time_horizon
... )</p>
</blockquote>
</blockquote>
</blockquote>
</details>







              <details class="quote">
                <summary>Source code in <code>src/PyDynSys/core/euclidean/non_autonomous.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NonAutonomousEuclideanDS</span><span class="p">(</span><span class="n">EuclideanDS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Non-autonomous Euclidean dynamical system.</span>

<span class="sd">    Systems where dx/dt = F(x, t) with F: R^n x R → R^n explicitly</span>
<span class="sd">    time-dependent. Equivalently, PartialDerivative(F, t) nonzero at some (x, t).</span>

<span class="sd">    Mathematical Properties:</span>
<span class="sd">    - Flow phi_t(x, t_0) depends on initial time t_0</span>
<span class="sd">    - Can be autonomized by augmenting state: y = (x, t), dy/dt = (F(x,t), 1)</span>
<span class="sd">    - Useful for periodically forced systems, time-varying parameters</span>

<span class="sd">    NOTE: All non autonomous systems can be autonomized by augmenting state: y = (x, t), </span>
<span class="sd">    dy/dt = (F(x,t), 1). However, this can alter topological properties and is not always </span>
<span class="sd">    desirable, hence our support for non-autonomous systems.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # Driven harmonic oscillator: x&#39;&#39; + x = sin(t)</span>
<span class="sd">        &gt;&gt;&gt; def driven_oscillator(x, t):</span>
<span class="sd">        ...     return np.array([x[1], -x[0] + np.sin(t)])</span>
<span class="sd">        &gt;&gt;&gt; phase_space = PhaseSpace.euclidean(2)</span>
<span class="sd">        &gt;&gt;&gt; time_horizon = TimeHorizon.real_line()</span>
<span class="sd">        &gt;&gt;&gt; sys = NonAutonomousEuclideanDS(</span>
<span class="sd">        ...     dimension=2, </span>
<span class="sd">        ...     vector_field=driven_oscillator,</span>
<span class="sd">        ...     phase_space=phase_space,</span>
<span class="sd">        ...     time_horizon=time_horizon</span>
<span class="sd">        ... )</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
        <span class="n">vector_field</span><span class="p">:</span> <span class="n">NonAutonomousVectorField</span><span class="p">,</span>
        <span class="n">phase_space</span><span class="p">:</span> <span class="n">PhaseSpace</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">time_horizon</span><span class="p">:</span> <span class="n">TimeHorizon</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize non-autonomous system.</span>

<span class="sd">        Args:</span>
<span class="sd">            dimension (int): Phase space dimension n</span>
<span class="sd">            vector_field: Function F(x, t): R^n x R → R^n, where F(x, t) = dx/dt</span>
<span class="sd">            phase_space (PhaseSpace): Phase space X subset of R^n (defaults to X = R^n)</span>
<span class="sd">            time_horizon (RealTimeHorizon): Time domain T subset of R (defaults to T = R)</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If dimension ≤ 0 or phase_space dimension mismatch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Enforce defaults</span>
        <span class="k">if</span> <span class="n">phase_space</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">phase_space</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="o">.</span><span class="n">euclidean</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">time_horizon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">time_horizon</span> <span class="o">=</span> <span class="n">TimeHorizon</span><span class="o">.</span><span class="n">real_line</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">phase_space</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vector_field</span> <span class="o">=</span> <span class="n">vector_field</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span> <span class="o">=</span> <span class="n">time_horizon</span>


       <span class="c1">### --- Abstract Methods --- ###</span>


    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">find_instantaneous_equilibria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find instantaneous equilibria at time t: x* s.t. F(x*, t) = 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: Implement &amp; decide on signature</span>
        <span class="k">pass</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">find_global_equilibria</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find global equilibria: x* s.t. F(x*, t) = 0 for all t.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>


        <span class="c1">### --- EuclideanDS Method Impls --- ###</span>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">vector_field</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NonAutonomousVectorField</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vector field defining the dynamical system.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vector_field</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">trajectory</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">t_eval</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;RK45&#39;</span><span class="p">,</span>
        <span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EuclideanTrajectory</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Solve initial value problem: dx/dt = F(x, t), x(t_0) = x_0.</span>

<span class="sd">        For non-autonomous systems, initial time t_0 matters and is required.</span>
<span class="sd">        If t_eval spans around t_0 (min(t_eval) &lt; t_0 &lt; max(t_eval)), performs</span>
<span class="sd">        bidirectional integration by integrating backward to min(t_eval) and</span>
<span class="sd">        forward to max(t_eval), then concatenating results (sol=None in this mode).</span>

<span class="sd">        Args:</span>
<span class="sd">            initial_state (NDArray[np.float64]): Initial condition x(t_0) in Phase space X</span>
<span class="sd">            t_span (Tuple[float, float]): Integration interval (t_start, t_end)</span>
<span class="sd">            t_eval (NDArray[np.float64]): Time points for explicit evaluation</span>
<span class="sd">            method (str): ODE solver (default &#39;RK45&#39;)</span>
<span class="sd">            dense_output (bool): If True, returns continuous interpolant (sol(t))</span>
<span class="sd">                -&gt; I am yet to see a use case where not true is needed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            EuclideanTrajectory: Trajectory object with attributes:</span>
<span class="sd">                - t: Evaluation times (property, concatenated from segments)</span>
<span class="sd">                - y: States at each time (property, concatenated from segments)</span>
<span class="sd">                - segments: List of trajectory segments</span>
<span class="sd">                - interpolate(t): Method for continuous evaluation at time t</span>
<span class="sd">                - domains: List of domain intervals for each segment </span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If state dimension incorrect, t_span invalid, </span>
<span class="sd">                       or t_eval points outside valid range</span>

<span class="sd">        Implementation Notes:</span>
<span class="sd">            - Solutions cached by (initial_state, t_span, t_eval, method)</span>
<span class="sd">            - Integrator uses lambda (t, x): self.vector_field(x, t) (uses both parameters)</span>
<span class="sd">            - Supports forward and backward integration via scipy</span>
<span class="sd">            - No existence/uniqueness checks performed (TODO: future)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
        <span class="n">t_min_eval</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t_eval</span><span class="p">))</span>
        <span class="n">t_max_eval</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t_eval</span><span class="p">))</span>
        <span class="n">spans_around_t0</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_min_eval</span> <span class="o">&lt;</span> <span class="n">t0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t0</span> <span class="o">&lt;</span> <span class="n">t_max_eval</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">spans_around_t0</span><span class="p">:</span>
            <span class="c1"># Bidirectional mode: ensure t0 and eval bounds are within time horizon</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">t0</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Initial time t0 = </span><span class="si">{</span><span class="n">t0</span><span class="si">}</span><span class="s2"> is not in time horizon T. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Time horizon bounds: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">bounds</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">t_min_eval</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">t_max_eval</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Evaluation interval [</span><span class="si">{</span><span class="n">t_min_eval</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">t_max_eval</span><span class="si">}</span><span class="s2">] not fully contained in time horizon T. &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;Time horizon bounds: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">bounds</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Unidirectional mode: enforce standard rules and require t0 to coincide with t_span[0]</span>
            <span class="k">if</span> <span class="n">t0</span> <span class="o">!=</span> <span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;For unidirectional integration, t0 must equal t_span[0]. Got t0=</span><span class="si">{</span><span class="n">t0</span><span class="si">}</span><span class="s2">, t_span[0]=</span><span class="si">{</span><span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_time_span</span><span class="p">(</span><span class="n">t_span</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_t_eval</span><span class="p">(</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">t_span</span><span class="p">)</span>

        <span class="c1"># ====================================================================</span>
        <span class="c1"># CACHING STRATEGY </span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># CRITICAL: for non-autonomous systems: initial_time t0 is part of the cache key!</span>
        <span class="c1"># </span>
        <span class="c1"># Unlike autonomous systems where time-translation doesn&#39;t matter,</span>
        <span class="c1"># non-autonomous systems have F(x,t) depending explicitly on time.</span>
        <span class="c1"># </span>
        <span class="c1"># Example demonstrating why t0 is critical:</span>
        <span class="c1">#   System: dx/dt = -x + sin(t)</span>
        <span class="c1">#   Same x_0 = 1.0 but different t0:</span>
        <span class="c1">#     - Solve from t0=0:   affected by sin(0)=0    → one trajectory</span>
        <span class="c1">#     - Solve from t0=π/2: affected by sin(pi/2)=1 → DIFFERENT trajectory!</span>
        <span class="c1"># </span>
        <span class="c1"># Cache key includes: (x_0, t_0, t_eval) but NOT method</span>
        <span class="n">cache_key</span> <span class="o">=</span> <span class="n">TrajectoryCacheKey</span><span class="p">(</span>
            <span class="n">initial_conditions</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">initial_state</span><span class="p">),</span>
            <span class="n">initial_time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span>  <span class="c1"># Use actual t0 parameter </span>
            <span class="n">t_eval_tuple</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Cache hit: Return previously computed trajectory</span>
        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>

        <span class="c1"># Solve IVP</span>
        <span class="k">if</span> <span class="n">spans_around_t0</span><span class="p">:</span>
            <span class="c1"># BIDIRECTIONAL CASE: t0 is interior to [min(t_eval), max(t_eval)]</span>
            <span class="c1"># </span>
            <span class="c1"># For non-autonomous systems, this is particularly important because</span>
            <span class="c1"># the vector field F(x,t) changes with time. We need accurate solutions</span>
            <span class="c1"># both before AND after t0 to capture time-dependent behavior.</span>
            <span class="c1">#</span>
            <span class="c1"># Example: Periodically forced oscillator with F(x,t) = -x + sin(ωt)</span>
            <span class="c1">#   At t&lt;0: forcing is negative (sin negative)</span>
            <span class="c1">#   At t&gt;0: forcing is positive (sin positive)</span>
            <span class="c1"># Bidirectional integration captures this transition.</span>

            <span class="c1"># Bidirectional case: create two segments and let Trajectory handle tangent domain</span>
            <span class="n">sol_backward_raw</span><span class="p">,</span> <span class="n">sol_forward_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_bidirectional_raw</span><span class="p">(</span>
                <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Wrap raw scipy solutions in segments</span>
            <span class="c1"># Each segment preserves its interpolant if dense_output=True</span>
            <span class="n">seg_backward</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
                <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">sol_backward_raw</span><span class="p">),</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span>
            <span class="p">)</span>
            <span class="n">seg_forward</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
                <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">sol_forward_raw</span><span class="p">),</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span>
            <span class="p">)</span>

            <span class="c1"># Merge via trajectory (handles tangent domain at t0 automatically)</span>
            <span class="n">trajectory</span> <span class="o">=</span> <span class="n">EuclideanTrajectory</span><span class="o">.</span><span class="n">from_segments</span><span class="p">([</span><span class="n">seg_backward</span><span class="p">,</span> <span class="n">seg_forward</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Unidirectional case: standard scipy call</span>
            <span class="n">solution_raw</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
                <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> 
                <span class="n">t_span</span><span class="o">=</span><span class="n">t_span</span><span class="p">,</span>
                <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span>
            <span class="p">)</span>

            <span class="c1"># Wrap in segment, then trajectory</span>
            <span class="n">segment</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
                <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">solution_raw</span><span class="p">),</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span>
            <span class="p">)</span>
            <span class="n">trajectory</span> <span class="o">=</span> <span class="n">EuclideanTrajectory</span><span class="o">.</span><span class="n">from_segments</span><span class="p">([</span><span class="n">segment</span><span class="p">])</span>

        <span class="c1"># Cache and return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">trajectory</span>
        <span class="k">return</span> <span class="n">trajectory</span>


        <span class="c1">### --- Public Methods --- ###</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">evolve</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;RK45&#39;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Single time-step evolution: estimate x(t_0 + dt) from x(t_0).</span>

<span class="sd">        For non-autonomous systems, the initial time t_0 is CRUCIAL! </span>
<span class="sd">        The same initial state at different times will evolve differently.</span>

<span class="sd">        Args:</span>
<span class="sd">            initial_state: State at time t_0</span>
<span class="sd">            t0: Initial time (ESSENTIAL for non-autonomous systems)</span>
<span class="sd">            dt: Time step (must be positive)</span>
<span class="sd">            method: ODE solver</span>

<span class="sd">        Returns:</span>
<span class="sd">            NDArray[np.float64]: Estimated state at t_0 + dt</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If state dimension incorrect or dt ≤ 0</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; # Driven oscillator evolves differently at different times</span>
<span class="sd">            &gt;&gt;&gt; x0 = np.array([1.0, 0.0])</span>
<span class="sd">            &gt;&gt;&gt; sys.evolve(x0, t0=0.0, dt=0.1)   # Different from</span>
<span class="sd">            &gt;&gt;&gt; sys.evolve(x0, t0=10.0, dt=0.1)  # this!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_time_step</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

        <span class="c1"># Single-step integration without caching</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
            <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>  <span class="c1"># Use both time and state</span>
            <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="p">),</span>
            <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
            <span class="n">t_eval</span><span class="o">=</span><span class="p">[</span><span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="p">],</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">dense_output</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Extract final state</span>


        <span class="c1">### --- Private Methods --- ###</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_validate_time_span</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override base validation to also check time horizon membership.</span>

<span class="sd">        For non-autonomous systems, we must verify that both endpoints of the</span>
<span class="sd">        integration interval lie within the time horizon T subset of R.</span>

<span class="sd">        Args:</span>
<span class="sd">            t_span (Tuple[float, float]): (t_start, t_end) interval</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If t_start == t_end or if either endpoint not in T</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># First, perform base validation (non-zero length)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_validate_time_span</span><span class="p">(</span><span class="n">t_span</span><span class="p">)</span>

        <span class="c1"># Then check time horizon membership</span>
        <span class="n">t_start</span><span class="p">,</span> <span class="n">t_end</span> <span class="o">=</span> <span class="n">t_span</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">t_start</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Initial time t_start = </span><span class="si">{</span><span class="n">t_start</span><span class="si">}</span><span class="s2"> is not in time horizon T. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Time horizon bounds: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">bounds</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">t_end</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Final time t_end = </span><span class="si">{</span><span class="n">t_end</span><span class="si">}</span><span class="s2"> is not in time horizon T. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Time horizon bounds: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">bounds</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_solve_bidirectional_raw</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">t_eval</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform bidirectional integration: backward from t_0, forward from t_0.</span>

<span class="sd">        Returns raw scipy OdeResult objects from both integrations, without</span>
<span class="sd">        concatenation. Concatenation is handled by EuclideanTrajectory.from_segments().</span>

<span class="sd">        Args:</span>
<span class="sd">            initial_state: x(t_0)</span>
<span class="sd">            t0: Initial time (interior to t_eval range)</span>
<span class="sd">            t_eval: Full evaluation array</span>
<span class="sd">            method: Solver method</span>
<span class="sd">            dense_output: Whether to generate interpolant for each segment</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[Any, Any]: (sol_backward, sol_forward) raw scipy OdeResult objects</span>

<span class="sd">        NOTE: Each segment can have dense_output if requested. The trajectory</span>
<span class="sd">        will handle dispatching interpolation to the correct segment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># SPLIT EVALUATION ARRAY FOR BIDIRECTIONAL INTEGRATION</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># Split t_eval into backward and forward portions around t0</span>
        <span class="c1">#</span>
        <span class="c1"># CRITICAL for non-autonomous systems: We must ensure BOTH segments include t0</span>
        <span class="c1"># to create tangent domains (no gap). This is even more important for non-autonomous</span>
        <span class="c1"># systems because interpolation across a gap would be undefined - we can&#39;t just</span>
        <span class="c1"># &quot;fill in&quot; missing values since the vector field F(x,t) depends on time.</span>
        <span class="c1">#</span>
        <span class="c1"># See autonomous.py::_solve_bidirectional_raw for detailed explanation of the</span>
        <span class="c1"># tangent domain issue and why we need to include t0 in both segments.</span>

        <span class="n">t_eval_backward</span> <span class="o">=</span> <span class="n">t_eval</span><span class="p">[</span><span class="n">t_eval</span> <span class="o">&lt;</span> <span class="n">t0</span><span class="p">]</span>   <span class="c1"># Points strictly before t0</span>
        <span class="n">t_eval_forward</span> <span class="o">=</span> <span class="n">t_eval</span><span class="p">[</span><span class="n">t_eval</span> <span class="o">&gt;=</span> <span class="n">t0</span><span class="p">]</span>   <span class="c1"># Points at or after t0</span>

        <span class="c1"># ====================================================================</span>
        <span class="c1"># BACKWARD INTEGRATION: t0 → min(t_eval)</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># Include t0 in backward to ensure tangent domain with forward segment</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_eval_backward</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Append t0 to backward evaluation points to ensure segment ends at t0</span>
            <span class="n">t_eval_backward_with_t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t_eval_backward</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span>
            <span class="n">sol_backward</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
                <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>
                <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">t_eval_backward</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span>
                <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval_backward_with_t0</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span><span class="p">,</span>  <span class="c1"># Allow dense output for segment</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sol_backward</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># ====================================================================</span>
        <span class="c1"># FORWARD INTEGRATION: t0 → max(t_eval)</span>
        <span class="c1"># ====================================================================</span>
        <span class="c1"># Ensure t0 is at the start to guarantee tangent domain</span>
        <span class="c1"># (Same logic as autonomous case - see autonomous.py for detailed explanation)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_eval_forward</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Check if t0 is already the first point (within floating-point tolerance)</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">t_eval_forward</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-10</span><span class="p">:</span>
                <span class="c1"># t0 is NOT in t_eval_forward, prepend it to ensure tangent domain</span>
                <span class="n">t_eval_forward_with_t0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="n">t0</span><span class="p">],</span> <span class="n">t_eval_forward</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># t0 is already present, no modification needed</span>
                <span class="n">t_eval_forward_with_t0</span> <span class="o">=</span> <span class="n">t_eval_forward</span>

            <span class="n">sol_forward</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
                <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>
                <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">t_eval_forward</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span>
                <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
                <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval_forward_with_t0</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
                <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span><span class="p">,</span>  <span class="c1"># Allow dense output for segment</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sol_forward</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Return raw solutions (let Trajectory handle merging)</span>
        <span class="k">return</span> <span class="n">sol_backward</span><span class="p">,</span> <span class="n">sol_forward</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="PyDynSys.core.euclidean.NonAutonomousEuclideanDS.vector_field" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">vector_field</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Vector field defining the dynamical system.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.NonAutonomousEuclideanDS.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">vector_field</span><span class="p">,</span> <span class="n">phase_space</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_horizon</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Initialize non-autonomous system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dimension</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Phase space dimension n</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>vector_field</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="NonAutonomousVectorField = Callable[[NDArray[np.float64], float], NDArray[np.float64]]

  
      module-attribute
   (PyDynSys.core.types.NonAutonomousVectorField)" href="../#PyDynSys.core.NonAutonomousVectorField">NonAutonomousVectorField</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function F(x, t): R^n x R → R^n, where F(x, t) = dx/dt</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phase_space</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.phase_space.PhaseSpace


  
      dataclass
  " href="phase_space/#PyDynSys.core.euclidean.phase_space.PhaseSpace">PhaseSpace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Phase space X subset of R^n (defaults to X = R^n)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_horizon</code>
            </td>
            <td>
                  <code><span title="RealTimeHorizon">RealTimeHorizon</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time domain T subset of R (defaults to T = R)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If dimension ≤ 0 or phase_space dimension mismatch</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/non_autonomous.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> 
    <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
    <span class="n">vector_field</span><span class="p">:</span> <span class="n">NonAutonomousVectorField</span><span class="p">,</span>
    <span class="n">phase_space</span><span class="p">:</span> <span class="n">PhaseSpace</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">time_horizon</span><span class="p">:</span> <span class="n">TimeHorizon</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize non-autonomous system.</span>

<span class="sd">    Args:</span>
<span class="sd">        dimension (int): Phase space dimension n</span>
<span class="sd">        vector_field: Function F(x, t): R^n x R → R^n, where F(x, t) = dx/dt</span>
<span class="sd">        phase_space (PhaseSpace): Phase space X subset of R^n (defaults to X = R^n)</span>
<span class="sd">        time_horizon (RealTimeHorizon): Time domain T subset of R (defaults to T = R)</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If dimension ≤ 0 or phase_space dimension mismatch</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Enforce defaults</span>
    <span class="k">if</span> <span class="n">phase_space</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">phase_space</span> <span class="o">=</span> <span class="n">PhaseSpace</span><span class="o">.</span><span class="n">euclidean</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">time_horizon</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">time_horizon</span> <span class="o">=</span> <span class="n">TimeHorizon</span><span class="o">.</span><span class="n">real_line</span><span class="p">()</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">phase_space</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_vector_field</span> <span class="o">=</span> <span class="n">vector_field</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span> <span class="o">=</span> <span class="n">time_horizon</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.NonAutonomousEuclideanDS.evolve" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">evolve</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Single time-step evolution: estimate x(t_0 + dt) from x(t_0).</p>
<p>For non-autonomous systems, the initial time t_0 is CRUCIAL! 
The same initial state at different times will evolve differently.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>initial_state</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>State at time t_0</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t0</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial time (ESSENTIAL for non-autonomous systems)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dt</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time step (must be positive)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ODE solver</p>
              </div>
            </td>
            <td>
                  <code>&#39;RK45&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>NDArray[np.float64]: Estimated state at t_0 + dt</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If state dimension incorrect or dt ≤ 0</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<h5 id="PyDynSys.core.euclidean.NonAutonomousEuclideanDS.evolve--driven-oscillator-evolves-differently-at-different-times">Driven oscillator evolves differently at different times</h5>
<p>x0 = np.array([1.0, 0.0])
sys.evolve(x0, t0=0.0, dt=0.1)   # Different from
sys.evolve(x0, t0=10.0, dt=0.1)  # this!</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/non_autonomous.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">evolve</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;RK45&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single time-step evolution: estimate x(t_0 + dt) from x(t_0).</span>

<span class="sd">    For non-autonomous systems, the initial time t_0 is CRUCIAL! </span>
<span class="sd">    The same initial state at different times will evolve differently.</span>

<span class="sd">    Args:</span>
<span class="sd">        initial_state: State at time t_0</span>
<span class="sd">        t0: Initial time (ESSENTIAL for non-autonomous systems)</span>
<span class="sd">        dt: Time step (must be positive)</span>
<span class="sd">        method: ODE solver</span>

<span class="sd">    Returns:</span>
<span class="sd">        NDArray[np.float64]: Estimated state at t_0 + dt</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If state dimension incorrect or dt ≤ 0</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # Driven oscillator evolves differently at different times</span>
<span class="sd">        &gt;&gt;&gt; x0 = np.array([1.0, 0.0])</span>
<span class="sd">        &gt;&gt;&gt; sys.evolve(x0, t0=0.0, dt=0.1)   # Different from</span>
<span class="sd">        &gt;&gt;&gt; sys.evolve(x0, t0=10.0, dt=0.1)  # this!</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_time_step</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

    <span class="c1"># Single-step integration without caching</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
        <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span>  <span class="c1"># Use both time and state</span>
        <span class="n">t_span</span><span class="o">=</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="p">),</span>
        <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
        <span class="n">t_eval</span><span class="o">=</span><span class="p">[</span><span class="n">t0</span> <span class="o">+</span> <span class="n">dt</span><span class="p">],</span>
        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="n">dense_output</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Extract final state</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.NonAutonomousEuclideanDS.find_global_equilibria" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_global_equilibria</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Find global equilibria: x<em> s.t. F(x</em>, t) = 0 for all t.</p>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/non_autonomous.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_global_equilibria</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find global equilibria: x* s.t. F(x*, t) = 0 for all t.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.NonAutonomousEuclideanDS.find_instantaneous_equilibria" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_instantaneous_equilibria</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Find instantaneous equilibria at time t: x<em> s.t. F(x</em>, t) = 0.</p>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/non_autonomous.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_instantaneous_equilibria</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Find instantaneous equilibria at time t: x* s.t. F(x*, t) = 0.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: Implement &amp; decide on signature</span>
    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.NonAutonomousEuclideanDS.trajectory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trajectory</span><span class="p">(</span><span class="n">initial_state</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">t_eval</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;RK45&#39;</span><span class="p">,</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Solve initial value problem: dx/dt = F(x, t), x(t_0) = x_0.</p>
<p>For non-autonomous systems, initial time t_0 matters and is required.
If t_eval spans around t_0 (min(t_eval) &lt; t_0 &lt; max(t_eval)), performs
bidirectional integration by integrating backward to min(t_eval) and
forward to max(t_eval), then concatenating results (sol=None in this mode).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>initial_state</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial condition x(t_0) in Phase space X</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_span</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Integration interval (t_start, t_end)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_eval</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time points for explicit evaluation</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ODE solver (default 'RK45')</p>
              </div>
            </td>
            <td>
                  <code>&#39;RK45&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dense_output</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, returns continuous interpolant (sol(t))
-&gt; I am yet to see a use case where not true is needed.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>EuclideanTrajectory</code></td>            <td>
                  <code><span title="PyDynSys.core.euclidean.trajectory.EuclideanTrajectory">EuclideanTrajectory</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Trajectory object with attributes:
- t: Evaluation times (property, concatenated from segments)
- y: States at each time (property, concatenated from segments)
- segments: List of trajectory segments
- interpolate(t): Method for continuous evaluation at time t
- domains: List of domain intervals for each segment </p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If state dimension incorrect, t_span invalid, 
       or t_eval points outside valid range</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="implementation-notes" open>
  <summary>Implementation Notes</summary>
  <ul>
<li>Solutions cached by (initial_state, t_span, t_eval, method)</li>
<li>Integrator uses lambda (t, x): self.vector_field(x, t) (uses both parameters)</li>
<li>Supports forward and backward integration via scipy</li>
<li>No existence/uniqueness checks performed (TODO: future)</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/non_autonomous.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trajectory</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">initial_state</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">t_span</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">t_eval</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span>
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;RK45&#39;</span><span class="p">,</span>
    <span class="n">dense_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EuclideanTrajectory</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve initial value problem: dx/dt = F(x, t), x(t_0) = x_0.</span>

<span class="sd">    For non-autonomous systems, initial time t_0 matters and is required.</span>
<span class="sd">    If t_eval spans around t_0 (min(t_eval) &lt; t_0 &lt; max(t_eval)), performs</span>
<span class="sd">    bidirectional integration by integrating backward to min(t_eval) and</span>
<span class="sd">    forward to max(t_eval), then concatenating results (sol=None in this mode).</span>

<span class="sd">    Args:</span>
<span class="sd">        initial_state (NDArray[np.float64]): Initial condition x(t_0) in Phase space X</span>
<span class="sd">        t_span (Tuple[float, float]): Integration interval (t_start, t_end)</span>
<span class="sd">        t_eval (NDArray[np.float64]): Time points for explicit evaluation</span>
<span class="sd">        method (str): ODE solver (default &#39;RK45&#39;)</span>
<span class="sd">        dense_output (bool): If True, returns continuous interpolant (sol(t))</span>
<span class="sd">            -&gt; I am yet to see a use case where not true is needed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        EuclideanTrajectory: Trajectory object with attributes:</span>
<span class="sd">            - t: Evaluation times (property, concatenated from segments)</span>
<span class="sd">            - y: States at each time (property, concatenated from segments)</span>
<span class="sd">            - segments: List of trajectory segments</span>
<span class="sd">            - interpolate(t): Method for continuous evaluation at time t</span>
<span class="sd">            - domains: List of domain intervals for each segment </span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If state dimension incorrect, t_span invalid, </span>
<span class="sd">                   or t_eval points outside valid range</span>

<span class="sd">    Implementation Notes:</span>
<span class="sd">        - Solutions cached by (initial_state, t_span, t_eval, method)</span>
<span class="sd">        - Integrator uses lambda (t, x): self.vector_field(x, t) (uses both parameters)</span>
<span class="sd">        - Supports forward and backward integration via scipy</span>
<span class="sd">        - No existence/uniqueness checks performed (TODO: future)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_validate_state</span><span class="p">(</span><span class="n">initial_state</span><span class="p">)</span>
    <span class="n">t_min_eval</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t_eval</span><span class="p">))</span>
    <span class="n">t_max_eval</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t_eval</span><span class="p">))</span>
    <span class="n">spans_around_t0</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_min_eval</span> <span class="o">&lt;</span> <span class="n">t0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">t0</span> <span class="o">&lt;</span> <span class="n">t_max_eval</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">spans_around_t0</span><span class="p">:</span>
        <span class="c1"># Bidirectional mode: ensure t0 and eval bounds are within time horizon</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">t0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Initial time t0 = </span><span class="si">{</span><span class="n">t0</span><span class="si">}</span><span class="s2"> is not in time horizon T. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Time horizon bounds: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">bounds</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">t_min_eval</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">t_max_eval</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Evaluation interval [</span><span class="si">{</span><span class="n">t_min_eval</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">t_max_eval</span><span class="si">}</span><span class="s2">] not fully contained in time horizon T. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Time horizon bounds: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time_horizon</span><span class="o">.</span><span class="n">bounds</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Unidirectional mode: enforce standard rules and require t0 to coincide with t_span[0]</span>
        <span class="k">if</span> <span class="n">t0</span> <span class="o">!=</span> <span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;For unidirectional integration, t0 must equal t_span[0]. Got t0=</span><span class="si">{</span><span class="n">t0</span><span class="si">}</span><span class="s2">, t_span[0]=</span><span class="si">{</span><span class="n">t_span</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_time_span</span><span class="p">(</span><span class="n">t_span</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_t_eval</span><span class="p">(</span><span class="n">t_eval</span><span class="p">,</span> <span class="n">t_span</span><span class="p">)</span>

    <span class="c1"># ====================================================================</span>
    <span class="c1"># CACHING STRATEGY </span>
    <span class="c1"># ====================================================================</span>
    <span class="c1"># CRITICAL: for non-autonomous systems: initial_time t0 is part of the cache key!</span>
    <span class="c1"># </span>
    <span class="c1"># Unlike autonomous systems where time-translation doesn&#39;t matter,</span>
    <span class="c1"># non-autonomous systems have F(x,t) depending explicitly on time.</span>
    <span class="c1"># </span>
    <span class="c1"># Example demonstrating why t0 is critical:</span>
    <span class="c1">#   System: dx/dt = -x + sin(t)</span>
    <span class="c1">#   Same x_0 = 1.0 but different t0:</span>
    <span class="c1">#     - Solve from t0=0:   affected by sin(0)=0    → one trajectory</span>
    <span class="c1">#     - Solve from t0=π/2: affected by sin(pi/2)=1 → DIFFERENT trajectory!</span>
    <span class="c1"># </span>
    <span class="c1"># Cache key includes: (x_0, t_0, t_eval) but NOT method</span>
    <span class="n">cache_key</span> <span class="o">=</span> <span class="n">TrajectoryCacheKey</span><span class="p">(</span>
        <span class="n">initial_conditions</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">initial_state</span><span class="p">),</span>
        <span class="n">initial_time</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span>  <span class="c1"># Use actual t0 parameter </span>
        <span class="n">t_eval_tuple</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">t_eval</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Cache hit: Return previously computed trajectory</span>
    <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>

    <span class="c1"># Solve IVP</span>
    <span class="k">if</span> <span class="n">spans_around_t0</span><span class="p">:</span>
        <span class="c1"># BIDIRECTIONAL CASE: t0 is interior to [min(t_eval), max(t_eval)]</span>
        <span class="c1"># </span>
        <span class="c1"># For non-autonomous systems, this is particularly important because</span>
        <span class="c1"># the vector field F(x,t) changes with time. We need accurate solutions</span>
        <span class="c1"># both before AND after t0 to capture time-dependent behavior.</span>
        <span class="c1">#</span>
        <span class="c1"># Example: Periodically forced oscillator with F(x,t) = -x + sin(ωt)</span>
        <span class="c1">#   At t&lt;0: forcing is negative (sin negative)</span>
        <span class="c1">#   At t&gt;0: forcing is positive (sin positive)</span>
        <span class="c1"># Bidirectional integration captures this transition.</span>

        <span class="c1"># Bidirectional case: create two segments and let Trajectory handle tangent domain</span>
        <span class="n">sol_backward_raw</span><span class="p">,</span> <span class="n">sol_forward_raw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solve_bidirectional_raw</span><span class="p">(</span>
            <span class="n">initial_state</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
            <span class="n">t0</span><span class="o">=</span><span class="n">t0</span><span class="p">,</span>
            <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Wrap raw scipy solutions in segments</span>
        <span class="c1"># Each segment preserves its interpolant if dense_output=True</span>
        <span class="n">seg_backward</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
            <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">sol_backward_raw</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span>
        <span class="p">)</span>
        <span class="n">seg_forward</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
            <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">sol_forward_raw</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span>
        <span class="p">)</span>

        <span class="c1"># Merge via trajectory (handles tangent domain at t0 automatically)</span>
        <span class="n">trajectory</span> <span class="o">=</span> <span class="n">EuclideanTrajectory</span><span class="o">.</span><span class="n">from_segments</span><span class="p">([</span><span class="n">seg_backward</span><span class="p">,</span> <span class="n">seg_forward</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Unidirectional case: standard scipy call</span>
        <span class="n">solution_raw</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span>
            <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> 
            <span class="n">t_span</span><span class="o">=</span><span class="n">t_span</span><span class="p">,</span>
            <span class="n">y0</span><span class="o">=</span><span class="n">initial_state</span><span class="p">,</span>
            <span class="n">t_eval</span><span class="o">=</span><span class="n">t_eval</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">dense_output</span><span class="o">=</span><span class="n">dense_output</span>
        <span class="p">)</span>

        <span class="c1"># Wrap in segment, then trajectory</span>
        <span class="n">segment</span> <span class="o">=</span> <span class="n">EuclideanTrajectorySegment</span><span class="o">.</span><span class="n">from_scipy_solution</span><span class="p">(</span>
            <span class="n">SciPyIvpSolution</span><span class="p">(</span><span class="n">raw_solution</span><span class="o">=</span><span class="n">solution_raw</span><span class="p">),</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span>
        <span class="p">)</span>
        <span class="n">trajectory</span> <span class="o">=</span> <span class="n">EuclideanTrajectory</span><span class="o">.</span><span class="n">from_segments</span><span class="p">([</span><span class="n">segment</span><span class="p">])</span>

    <span class="c1"># Cache and return</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_solutions_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">trajectory</span>
    <span class="k">return</span> <span class="n">trajectory</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="PyDynSys.core.euclidean.PhaseSpace" class="doc doc-heading">
            <code>PhaseSpace</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Phase space X subset of R^n with flexible symbolic/callable representation. </p>


<details class="supports-three-usage-patterns" open>
  <summary>Supports three usage patterns</summary>
  <ol>
<li>Symbolic only: Provides symbolic set, constraint auto-compiled (general) </li>
<li>Callable only: Provides constraint directly (fast, no symbolic ops) </li>
<li>Both (recommended): Provides both for optimal performance (fast + symbolic ops)</li>
</ol>
</details>

<details class="symbolic-representation-enables" open>
  <summary>Symbolic representation enables</summary>
  <ul>
<li>Rigorous mathematical operations (intersections, closures, etc.) </li>
<li>Pretty printing for dynamical system descriptors </li>
</ul>
</details>        <p>Callable representation provides O(1) membership testing for numerical work.</p>


<details class="fields" open>
  <summary>Fields</summary>
  <ul>
<li>dimension (int): Phase space dimension n </li>
<li>symbolic_set (syp.Set | None): Optional SymPy set representation </li>
<li>constraint (Callable | None): Optional callable for fast membership testing</li>
</ul>
</details>        <p>Note: At least one of symbolic_set or constraint must be provided, or a ValueError will be raised.</p>








              <details class="quote">
                <summary>Source code in <code>src/PyDynSys/core/euclidean/phase_space.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PhaseSpace</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Phase space X subset of R^n with flexible symbolic/callable representation. </span>

<span class="sd">    Supports three usage patterns: </span>
<span class="sd">        1. Symbolic only: Provides symbolic set, constraint auto-compiled (general) </span>
<span class="sd">        2. Callable only: Provides constraint directly (fast, no symbolic ops) </span>
<span class="sd">        3. Both (recommended): Provides both for optimal performance (fast + symbolic ops)</span>

<span class="sd">    Symbolic representation enables: </span>
<span class="sd">        - Rigorous mathematical operations (intersections, closures, etc.) </span>
<span class="sd">        - Pretty printing for dynamical system descriptors </span>

<span class="sd">    Callable representation provides O(1) membership testing for numerical work.</span>

<span class="sd">    Fields: </span>
<span class="sd">        - dimension (int): Phase space dimension n </span>
<span class="sd">        - symbolic_set (syp.Set | None): Optional SymPy set representation </span>
<span class="sd">        - constraint (Callable | None): Optional callable for fast membership testing</span>

<span class="sd">    Note: At least one of symbolic_set or constraint must be provided, or a ValueError will be raised.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">symbolic_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">syp</span><span class="o">.</span><span class="n">Set</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">constraint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>


        <span class="c1">### --- Construction --- ###</span>


    <span class="c1">## __init__ autogenerated by @dataclass decorator</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span>
        <span class="bp">self</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Post-construction Validation:   </span>

<span class="sd">        Raises: </span>
<span class="sd">            ValueError: If both symbolic_set and constraint are None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;PhaseSpace requires at least one representation: &quot;</span>
                <span class="s2">&quot;symbolic_set (sympy.Set) or constraint (Callable[[NDArray[np.float64]], bool]) must be provided&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Compile constraint from symbolic set: yields slow containment checks</span>
            <span class="c1">## NOTE: I&#39;m not actually sure of the time complexity, need to check sympy docs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_constraint</span><span class="p">()</span> 


        <span class="c1">### --- Factory Methods --- ###</span>


    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">full</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory: X = R^n (full Euclidean space).</span>

<span class="sd">        - The phase space of choice for unconstrained systems. </span>
<span class="sd">        - Provides both symbolic representation and optimized constraint, optimal performance (o(1) membership testing)</span>

<span class="sd">        Args:</span>
<span class="sd">            dimension (int): Phase space dimension n</span>

<span class="sd">        Returns:</span>
<span class="sd">            PhaseSpace instance representing R^n, optimal performance case</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If dimension is not positive</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dimension</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimension must be positive, got dimension: </span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">symbolic</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span> <span class="o">**</span> <span class="n">dimension</span>
        <span class="n">constraint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span> <span class="c1"># Provide constraint directly to avoid compilation overhead</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">symbolic_set</span><span class="o">=</span><span class="n">symbolic</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">)</span>


    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">box</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory: X = [a_1, b_1] x ... x [a_n, b_n] (box-space constructor).</span>

<span class="sd">        - Invokes PhaseSpace constructor with both symbolic representation and in-built callable constraint.</span>
<span class="sd">            - Symbolic representation is a sympy.sets.ProductSet of sympy.Interval instances. </span>
<span class="sd">        - Dimension is inferred from the bounds array.</span>

<span class="sd">        Args:</span>
<span class="sd">            bounds: Array of shape (n, 2) with [[a_1, b_1], ..., [a_n, b_n]]</span>

<span class="sd">        Returns:</span>
<span class="sd">            PhaseSpace with box constraints and optimal performance</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If bounds is not a numpy array of shape (n, 2) for n &gt;= 1</span>
<span class="sd">            ValueError: If any i is s.t. b_i &lt;= a_i</span>
<span class="sd">            TypeError: If bounds is not a numpy array of type float64</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">bounds</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bounds must be a numpy array of shape (n, 2) for n &gt;= 1, got </span><span class="si">{</span><span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">bounds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For all i, b_i must be greater than a_i, got bounds: </span><span class="si">{</span><span class="n">bounds</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bounds</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of type float64, got center: </span><span class="si">{</span><span class="n">bounds</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;Use numpy.array(bounds, dtype=np.float64) to convert to float64&quot;</span>
            <span class="p">)</span>

        <span class="n">dimension</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">intervals</span> <span class="o">=</span> <span class="p">[</span><span class="n">syp</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">)]</span>
        <span class="n">symbolic</span> <span class="o">=</span> <span class="n">ProductSet</span><span class="p">(</span><span class="o">*</span><span class="n">intervals</span><span class="p">)</span>

        <span class="c1"># Provide pre-compiled constraint for performance: 2*dimension comparisons (O(dimension))</span>
        <span class="n">box_constraint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])))</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">symbolic_set</span><span class="o">=</span><span class="n">symbolic</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">box_constraint</span><span class="p">)</span>


    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">closed_hypersphere</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory: X = {x in R^n : ||x - center|| &lt;= radius} (sphere constructor).</span>

<span class="sd">        - Invokes PhaseSpace constructor with both symbolic representation and in-built callable constraint.</span>
<span class="sd">            - Symbolic representation is a sympy.sets.Ball instance.</span>
<span class="sd">        - Dimension is inferred from the center array.</span>

<span class="sd">        Args:</span>
<span class="sd">            center (NDArray[np.float64]): Array of shape (n,) with the center of the sphere</span>
<span class="sd">            radius (float): Radius of the sphere</span>

<span class="sd">        Returns:</span>
<span class="sd">            PhaseSpace with closed hypersphere constraints and optimal performance</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If radius &lt;= 0</span>
<span class="sd">            ValueError: If center is not a numpy array of shape (n,) for some n</span>
<span class="sd">            TypeError: If center is not a numpy array of type float64</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radius must be positive, got radius: </span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of shape (n,) for some n, got center: </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">center</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of type float64, got center: </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;Use numpy.array(center, dtype=np.float64) to convert to float64&quot;</span>
            <span class="p">)</span>

        <span class="n">dimension</span> <span class="o">=</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">R_n</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span> <span class="o">**</span> <span class="n">dimension</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x0:</span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">squared_dist</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">))</span>
        <span class="n">symbolic</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">ConditionSet</span><span class="p">(</span><span class="n">syp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">squared_dist</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">R_n</span><span class="p">)</span>

        <span class="c1"># Constraint is O(dimension) </span>
            <span class="c1">## TODO: How does np.linalg.norm work? If they sqrt could be slow, squard sum &gt;&gt;</span>
        <span class="n">closed_hypersphere_constraint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">)</span> 
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">symbolic_set</span><span class="o">=</span><span class="n">symbolic</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">closed_hypersphere_constraint</span><span class="p">)</span>


    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">open_hypersphere</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory: X = {x in R^n : ||x - center|| &lt; radius} (open hypersphere constructor).</span>

<span class="sd">        - Invokes PhaseSpace constructor with both symbolic representation and in-built callable constraint.</span>
<span class="sd">            - Symbolic representation is a sympy.sets.Ball instance.</span>
<span class="sd">        - Dimension is inferred from the center array.</span>
<span class="sd">        - Sympy ConditionSet is used to represent the open hypersphere, allowing for set-theoretic operation support.</span>

<span class="sd">        Args:</span>
<span class="sd">            center (NDArray[np.float64]): Array of shape (n,) with the center of the sphere</span>
<span class="sd">            radius (float): Radius of the sphere</span>

<span class="sd">        Returns:</span>
<span class="sd">            PhaseSpace with open hypersphere constraints and optimal performance</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If radius &lt;= 0</span>
<span class="sd">            ValueError: If center is not a numpy array of shape (n,) for some n</span>
<span class="sd">            TypeError: If center is not a numpy array of type float64</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radius must be positive, got radius: </span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of shape (n,) for some n, got center: </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">center</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of type float64, got center: </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;Use numpy.array(center, dtype=np.float64) to convert to float64&quot;</span>
            <span class="p">)</span>

        <span class="n">dimension</span> <span class="o">=</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">R_n</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span> <span class="o">**</span> <span class="n">dimension</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x0:</span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">squared_dist</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">))</span>
        <span class="n">symbolic</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">ConditionSet</span><span class="p">(</span><span class="n">syp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">squared_dist</span> <span class="o">&lt;</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">R_n</span><span class="p">)</span>

        <span class="c1"># Constraint is O(dimension) </span>
            <span class="c1">## TODO: How does np.linalg.norm work? If they sqrt could be slow, squard sum &gt;&gt;</span>
        <span class="n">constraint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">radius</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">symbolic_set</span><span class="o">=</span><span class="n">symbolic</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">)</span>


    <span class="c1">### --- Public Methods --- ### </span>


    <span class="k">def</span><span class="w"> </span><span class="nf">contains_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if x in X using given callable constraint, if provided, if not deferring to compiled constraint (slow).</span>

<span class="sd">        Args:</span>
<span class="sd">            x (NDArray[np.float64]): Point in R^n to test</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if x in X, False otherwise</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: If constraint is not set in __post_init__</span>
<span class="sd">            ValueError: x is not a numpy array of shape (n,)     </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Constraint should be set in __post_init__&quot;</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;x has incorrect dimension: expected (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">,), got </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">contains_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if all points in X are in X using compiled constraint.</span>

<span class="sd">        Args:</span>
<span class="sd">            X (NDArray[np.float64]): Points in R^n to test, shape (n_points, n)</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if all points in X are in X, False otherwise</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: X is not a numpy array of shape (n_points, n)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n_points</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">n_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;X has incorrect shape: expected (</span><span class="si">{</span><span class="n">n_points</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">), got </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">contains_point</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">])</span>


    <span class="c1">### --- Properties --- ### </span>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">volume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        CURRENTLY NOT IMPLEMENTED - DEFERRED TO FUTURE VERSIONS</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Volume of X</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Volume is not implemented for PhaseSpace&quot;</span><span class="p">)</span>


    <span class="c1">### --- Dunder Methods --- ### </span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;PhaseSpace(dimension=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">): No symbolic representation&quot;</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span> 
        <span class="n">symbolic_repr</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>
        <span class="n">constraint_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">constraint_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint</span><span class="p">,</span> <span class="s2">&quot;__name__&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;PhaseSpace(dimension=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;symbolic_set=</span><span class="si">{</span><span class="n">symbolic_repr</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;constraint=</span><span class="si">{</span><span class="n">constraint_name</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PhaseSpace</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="c1"># Equality iff mutual subset</span>
        <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">left</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">left</span> <span class="ow">and</span> <span class="n">right</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">eq</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>  <span class="c1"># type: ignore[comparison-overlap]</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">eq</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PhaseSpace</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="n">le</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">le</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PhaseSpace</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PhaseSpace</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="n">ge</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ge</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">PhaseSpace</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="c1">### --- Private Methods --- ### </span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_compile_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compile symbolic set to callable for fast numerical membership testing.</span>

<span class="sd">        Only called when symbolic_set is provided but constraint is not.</span>

<span class="sd">        Strategy:</span>
<span class="sd">        - For R^n (unbounded): return lambda x: True (no constraint)</span>
<span class="sd">        - For ProductSets of Intervals: extract bounds, compile to numpy checks</span>
<span class="sd">        - For general sets: use sympy&#39;s contains (slow, but general)</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: If symbolic_set is None (should never happen)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Cannot compile constraint without symbolic_set&quot;</span>

        <span class="c1"># Special case: R^n (ProductSet of Reals or Reals**n)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_full_euclidean_space</span><span class="p">():</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span>

        <span class="c1"># Special case: ProductSet of Intervals → box constraints</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">,</span> <span class="n">ProductSet</span><span class="p">):</span>
            <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_box_bounds</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">def</span><span class="w"> </span><span class="nf">box_constraint</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])))</span>
                <span class="k">return</span> <span class="n">box_constraint</span>

        <span class="c1"># General case: use sympy (slow)</span>
        <span class="c1"># Prefer set.contains(Tuple(...)) over geometric Point for generic sets</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">symbolic_constraint</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">syp</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span>
                <span class="n">contains_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
                <span class="c1"># SymPy returns a Boolean or a symbolic expression; coerce if possible</span>
                <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">contains_expr</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">symbolic_constraint</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_is_full_euclidean_space</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if symbolic set represents R^n.</span>

<span class="sd">        Returns False if symbolic_set is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">,</span> <span class="n">ProductSet</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
        <span class="c1"># Also check for Reals**n notation</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">,</span> <span class="s1">&#39;base&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">base</span> <span class="o">==</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">exp</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span>
        <span class="k">return</span> <span class="kc">False</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_extract_box_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract box bounds from ProductSet of Intervals.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Array of shape (n, 2) with [[a1, b1], ..., [an, bn]], or None</span>
<span class="sd">            if not a product of intervals or if symbolic_set is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">,</span> <span class="n">ProductSet</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">component_set</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_set</span><span class="p">,</span> <span class="n">syp</span><span class="o">.</span><span class="n">Interval</span><span class="p">):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">component_set</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="k">if</span> <span class="n">component_set</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">is_finite</span> <span class="k">else</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
                <span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">component_set</span><span class="o">.</span><span class="n">end</span><span class="p">)</span> <span class="k">if</span> <span class="n">component_set</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">is_finite</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
                <span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">component_set</span> <span class="o">==</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span><span class="p">:</span>
                <span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Not a simple interval</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_subseteq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;PhaseSpace&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if self is a subset of other using symbolic set containment.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (PhaseSpace): The other PhaseSpace to compare against</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if self is a subset of other, False otherwise</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If self or other has no symbolic representation</span>
<span class="sd">            Warning: If subset relation is undecidable symbolically, falling back to false result</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">symbolic_set</span>
        <span class="k">if</span> <span class="n">A</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">B</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cannot compare PhaseSpaces with no symbolic representation: A=</span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s2">, B=</span><span class="si">{</span><span class="n">B</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">is_subset</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Subset relation is undecidable symbolically; falling back to false result: Tried A &lt;= B&quot;</span>
        <span class="s2">&quot;where A: </span><span class="si">{A}</span><span class="s2">, B: </span><span class="si">{B}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="PyDynSys.core.euclidean.PhaseSpace.volume" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">volume</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>CURRENTLY NOT IMPLEMENTED - DEFERRED TO FUTURE VERSIONS</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Volume of X</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.PhaseSpace.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Post-construction Validation:   </p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If both symbolic_set and constraint are None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/phase_space.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Post-construction Validation:   </span>

<span class="sd">    Raises: </span>
<span class="sd">        ValueError: If both symbolic_set and constraint are None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;PhaseSpace requires at least one representation: &quot;</span>
            <span class="s2">&quot;symbolic_set (sympy.Set) or constraint (Callable[[NDArray[np.float64]], bool]) must be provided&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Compile constraint from symbolic set: yields slow containment checks</span>
        <span class="c1">## NOTE: I&#39;m not actually sure of the time complexity, need to check sympy docs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_constraint</span><span class="p">()</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.PhaseSpace.box" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">box</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Factory: X = [a_1, b_1] x ... x [a_n, b_n] (box-space constructor).</p>
<ul>
<li>Invokes PhaseSpace constructor with both symbolic representation and in-built callable constraint.<ul>
<li>Symbolic representation is a sympy.sets.ProductSet of sympy.Interval instances. </li>
</ul>
</li>
<li>Dimension is inferred from the bounds array.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>bounds</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of shape (n, 2) with [[a_1, b_1], ..., [a_n, b_n]]</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.phase_space.PhaseSpace


  
      dataclass
  " href="phase_space/#PyDynSys.core.euclidean.phase_space.PhaseSpace">PhaseSpace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PhaseSpace with box constraints and optimal performance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If bounds is not a numpy array of shape (n, 2) for n &gt;= 1</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any i is s.t. b_i &lt;= a_i</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If bounds is not a numpy array of type float64</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/phase_space.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">box</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bounds</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory: X = [a_1, b_1] x ... x [a_n, b_n] (box-space constructor).</span>

<span class="sd">    - Invokes PhaseSpace constructor with both symbolic representation and in-built callable constraint.</span>
<span class="sd">        - Symbolic representation is a sympy.sets.ProductSet of sympy.Interval instances. </span>
<span class="sd">    - Dimension is inferred from the bounds array.</span>

<span class="sd">    Args:</span>
<span class="sd">        bounds: Array of shape (n, 2) with [[a_1, b_1], ..., [a_n, b_n]]</span>

<span class="sd">    Returns:</span>
<span class="sd">        PhaseSpace with box constraints and optimal performance</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If bounds is not a numpy array of shape (n, 2) for n &gt;= 1</span>
<span class="sd">        ValueError: If any i is s.t. b_i &lt;= a_i</span>
<span class="sd">        TypeError: If bounds is not a numpy array of type float64</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bounds</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bounds must be a numpy array of shape (n, 2) for n &gt;= 1, got </span><span class="si">{</span><span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">bounds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;For all i, b_i must be greater than a_i, got bounds: </span><span class="si">{</span><span class="n">bounds</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bounds</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of type float64, got center: </span><span class="si">{</span><span class="n">bounds</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Use numpy.array(bounds, dtype=np.float64) to convert to float64&quot;</span>
        <span class="p">)</span>

    <span class="n">dimension</span> <span class="o">=</span> <span class="n">bounds</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">intervals</span> <span class="o">=</span> <span class="p">[</span><span class="n">syp</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">bounds</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bounds</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">)]</span>
    <span class="n">symbolic</span> <span class="o">=</span> <span class="n">ProductSet</span><span class="p">(</span><span class="o">*</span><span class="n">intervals</span><span class="p">)</span>

    <span class="c1"># Provide pre-compiled constraint for performance: 2*dimension comparisons (O(dimension))</span>
    <span class="n">box_constraint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])))</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">symbolic_set</span><span class="o">=</span><span class="n">symbolic</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">box_constraint</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.PhaseSpace.closed_hypersphere" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">closed_hypersphere</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Factory: X = {x in R^n : ||x - center|| &lt;= radius} (sphere constructor).</p>
<ul>
<li>Invokes PhaseSpace constructor with both symbolic representation and in-built callable constraint.<ul>
<li>Symbolic representation is a sympy.sets.Ball instance.</li>
</ul>
</li>
<li>Dimension is inferred from the center array.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>center</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of shape (n,) with the center of the sphere</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius of the sphere</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.phase_space.PhaseSpace


  
      dataclass
  " href="phase_space/#PyDynSys.core.euclidean.phase_space.PhaseSpace">PhaseSpace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PhaseSpace with closed hypersphere constraints and optimal performance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If radius &lt;= 0</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If center is not a numpy array of shape (n,) for some n</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If center is not a numpy array of type float64</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/phase_space.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">closed_hypersphere</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory: X = {x in R^n : ||x - center|| &lt;= radius} (sphere constructor).</span>

<span class="sd">    - Invokes PhaseSpace constructor with both symbolic representation and in-built callable constraint.</span>
<span class="sd">        - Symbolic representation is a sympy.sets.Ball instance.</span>
<span class="sd">    - Dimension is inferred from the center array.</span>

<span class="sd">    Args:</span>
<span class="sd">        center (NDArray[np.float64]): Array of shape (n,) with the center of the sphere</span>
<span class="sd">        radius (float): Radius of the sphere</span>

<span class="sd">    Returns:</span>
<span class="sd">        PhaseSpace with closed hypersphere constraints and optimal performance</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If radius &lt;= 0</span>
<span class="sd">        ValueError: If center is not a numpy array of shape (n,) for some n</span>
<span class="sd">        TypeError: If center is not a numpy array of type float64</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">radius</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radius must be positive, got radius: </span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of shape (n,) for some n, got center: </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">center</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of type float64, got center: </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Use numpy.array(center, dtype=np.float64) to convert to float64&quot;</span>
        <span class="p">)</span>

    <span class="n">dimension</span> <span class="o">=</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">R_n</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span> <span class="o">**</span> <span class="n">dimension</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x0:</span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">squared_dist</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">))</span>
    <span class="n">symbolic</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">ConditionSet</span><span class="p">(</span><span class="n">syp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">squared_dist</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">R_n</span><span class="p">)</span>

    <span class="c1"># Constraint is O(dimension) </span>
        <span class="c1">## TODO: How does np.linalg.norm work? If they sqrt could be slow, squard sum &gt;&gt;</span>
    <span class="n">closed_hypersphere_constraint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">radius</span><span class="p">)</span> 
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">symbolic_set</span><span class="o">=</span><span class="n">symbolic</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">closed_hypersphere_constraint</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.PhaseSpace.contains_point" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains_point</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Check if x in X using given callable constraint, if provided, if not deferring to compiled constraint (slow).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Point in R^n to test</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if x in X, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="AssertionError">AssertionError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If constraint is not set in <strong>post_init</strong></p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>x is not a numpy array of shape (n,)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/phase_space.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contains_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if x in X using given callable constraint, if provided, if not deferring to compiled constraint (slow).</span>

<span class="sd">    Args:</span>
<span class="sd">        x (NDArray[np.float64]): Point in R^n to test</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if x in X, False otherwise</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If constraint is not set in __post_init__</span>
<span class="sd">        ValueError: x is not a numpy array of shape (n,)     </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Constraint should be set in __post_init__&quot;</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">,):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;x has incorrect dimension: expected (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">,), got </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.PhaseSpace.contains_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains_points</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Check if all points in X are in X using compiled constraint.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Points in R^n to test, shape (n_points, n)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all points in X are in X, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>X is not a numpy array of shape (n_points, n)</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/phase_space.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contains_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if all points in X are in X using compiled constraint.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (NDArray[np.float64]): Points in R^n to test, shape (n_points, n)</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if all points in X are in X, False otherwise</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: X is not a numpy array of shape (n_points, n)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_points</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="n">n_points</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;X has incorrect shape: expected (</span><span class="si">{</span><span class="n">n_points</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span><span class="si">}</span><span class="s2">), got </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">contains_point</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">X</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.PhaseSpace.full" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">full</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Factory: X = R^n (full Euclidean space).</p>
<ul>
<li>The phase space of choice for unconstrained systems. </li>
<li>Provides both symbolic representation and optimized constraint, optimal performance (o(1) membership testing)</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dimension</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Phase space dimension n</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.phase_space.PhaseSpace


  
      dataclass
  " href="phase_space/#PyDynSys.core.euclidean.phase_space.PhaseSpace">PhaseSpace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PhaseSpace instance representing R^n, optimal performance case</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If dimension is not positive</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/phase_space.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">full</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory: X = R^n (full Euclidean space).</span>

<span class="sd">    - The phase space of choice for unconstrained systems. </span>
<span class="sd">    - Provides both symbolic representation and optimized constraint, optimal performance (o(1) membership testing)</span>

<span class="sd">    Args:</span>
<span class="sd">        dimension (int): Phase space dimension n</span>

<span class="sd">    Returns:</span>
<span class="sd">        PhaseSpace instance representing R^n, optimal performance case</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If dimension is not positive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dimension</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dimension must be positive, got dimension: </span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">symbolic</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span> <span class="o">**</span> <span class="n">dimension</span>
    <span class="n">constraint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span> <span class="c1"># Provide constraint directly to avoid compilation overhead</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">symbolic_set</span><span class="o">=</span><span class="n">symbolic</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.PhaseSpace.open_hypersphere" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">open_hypersphere</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Factory: X = {x in R^n : ||x - center|| &lt; radius} (open hypersphere constructor).</p>
<ul>
<li>Invokes PhaseSpace constructor with both symbolic representation and in-built callable constraint.<ul>
<li>Symbolic representation is a sympy.sets.Ball instance.</li>
</ul>
</li>
<li>Dimension is inferred from the center array.</li>
<li>Sympy ConditionSet is used to represent the open hypersphere, allowing for set-theoretic operation support.</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>center</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of shape (n,) with the center of the sphere</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>radius</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Radius of the sphere</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.phase_space.PhaseSpace


  
      dataclass
  " href="phase_space/#PyDynSys.core.euclidean.phase_space.PhaseSpace">PhaseSpace</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PhaseSpace with open hypersphere constraints and optimal performance</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If radius &lt;= 0</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If center is not a numpy array of shape (n,) for some n</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If center is not a numpy array of type float64</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/phase_space.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">open_hypersphere</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">center</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">],</span> <span class="n">radius</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;PhaseSpace&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory: X = {x in R^n : ||x - center|| &lt; radius} (open hypersphere constructor).</span>

<span class="sd">    - Invokes PhaseSpace constructor with both symbolic representation and in-built callable constraint.</span>
<span class="sd">        - Symbolic representation is a sympy.sets.Ball instance.</span>
<span class="sd">    - Dimension is inferred from the center array.</span>
<span class="sd">    - Sympy ConditionSet is used to represent the open hypersphere, allowing for set-theoretic operation support.</span>

<span class="sd">    Args:</span>
<span class="sd">        center (NDArray[np.float64]): Array of shape (n,) with the center of the sphere</span>
<span class="sd">        radius (float): Radius of the sphere</span>

<span class="sd">    Returns:</span>
<span class="sd">        PhaseSpace with open hypersphere constraints and optimal performance</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If radius &lt;= 0</span>
<span class="sd">        ValueError: If center is not a numpy array of shape (n,) for some n</span>
<span class="sd">        TypeError: If center is not a numpy array of type float64</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">radius</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radius must be positive, got radius: </span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of shape (n,) for some n, got center: </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">center</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Center must be a numpy array of type float64, got center: </span><span class="si">{</span><span class="n">center</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Use numpy.array(center, dtype=np.float64) to convert to float64&quot;</span>
        <span class="p">)</span>

    <span class="n">dimension</span> <span class="o">=</span> <span class="n">center</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">R_n</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span> <span class="o">**</span> <span class="n">dimension</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;x0:</span><span class="si">{</span><span class="n">dimension</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">squared_dist</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">center</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">dimension</span><span class="p">))</span>
    <span class="n">symbolic</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">ConditionSet</span><span class="p">(</span><span class="n">syp</span><span class="o">.</span><span class="n">Tuple</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">squared_dist</span> <span class="o">&lt;</span> <span class="n">radius</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">R_n</span><span class="p">)</span>

    <span class="c1"># Constraint is O(dimension) </span>
        <span class="c1">## TODO: How does np.linalg.norm work? If they sqrt could be slow, squard sum &gt;&gt;</span>
    <span class="n">constraint</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">bool</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">radius</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">,</span> <span class="n">symbolic_set</span><span class="o">=</span><span class="n">symbolic</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="PyDynSys.core.euclidean.TimeHorizon" class="doc doc-heading">
            <code>TimeHorizon</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Time horizon T subset of R for non-autonomous systems.</p>
<p>Factories:
- Unbounded: T = R (default)
- Closed Interval: T = [a, b]
- Open Interval: T = (a, b) </p>
<p>Supports:
- Predicate: T = {t : constraint(t) = True}</p>


<details class="fields" open>
  <summary>Fields</summary>
  <p>symbolic_set (syp.Set | None): Optional SymPy set representation
constraint (Callable[[float], bool] | None): Optional callable for fast membership testing</p>
</details>        <ul>
<li>At least one of symbolic_set or constraint must be provided, or a ValueError will be raised upon construction.</li>
</ul>








              <details class="quote">
                <summary>Source code in <code>src/PyDynSys/core/euclidean/time_horizon.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">TimeHorizon</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Time horizon T subset of R for non-autonomous systems.</span>

<span class="sd">    Factories:</span>
<span class="sd">    - Unbounded: T = R (default)</span>
<span class="sd">    - Closed Interval: T = [a, b]</span>
<span class="sd">    - Open Interval: T = (a, b) </span>

<span class="sd">    Supports:</span>
<span class="sd">    - Predicate: T = {t : constraint(t) = True}</span>

<span class="sd">    Fields:</span>
<span class="sd">        symbolic_set (syp.Set | None): Optional SymPy set representation</span>
<span class="sd">        constraint (Callable[[float], bool] | None): Optional callable for fast membership testing</span>

<span class="sd">    - At least one of symbolic_set or constraint must be provided, or a ValueError will be raised upon construction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">symbolic_set</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">syp</span><span class="o">.</span><span class="n">Set</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">constraint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">float</span><span class="p">],</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>


        <span class="c1">### --- Construction --- ###</span>


    <span class="c1">## __init__ autogenerated by @dataclass decorator</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span>
        <span class="bp">self</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Post-construction Validation:   </span>

<span class="sd">        Raises: </span>
<span class="sd">            ValueError: If both symbolic_set and constraint are None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;PhaseSpace requires at least one representation: &quot;</span>
                <span class="s2">&quot;symbolic_set (sympy.Set) or constraint (Callable[[NDArray[np.float64]], bool]) must be provided&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Compile constraint from symbolic set: yields slow containment checks</span>
            <span class="c1">## NOTE: I&#39;m not actually sure of the time complexity, need to check sympy docs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_constraint</span><span class="p">()</span> 


            <span class="c1">### --- Public Methods --- ### </span>


    <span class="k">def</span><span class="w"> </span><span class="nf">contains_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if t is in T.</span>

<span class="sd">        Args:</span>
<span class="sd">            t: Time point to test</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if t in T, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">contains_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check if all times in t are in T.</span>

<span class="sd">        Args:</span>
<span class="sd">            t: Times to test</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if all times in t are in T, False otherwise</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">contains_time</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t</span><span class="p">])</span>


        <span class="c1">### --- Factory Methods --- ### </span>


    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">real_line</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory: T = R (entire real line).</span>

<span class="sd">        This is the DEFAULT time horizon for non-autonomous systems.</span>

<span class="sd">        Returns:</span>
<span class="sd">            TimeHorizon representing R</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">symbolic_set</span><span class="o">=</span><span class="n">syp</span><span class="o">.</span><span class="n">Reals</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">closed_interval</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">t_min</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory: T = [t_min, t_max] (bounded interval).</span>

<span class="sd">        Args:</span>
<span class="sd">            t_min: Lower bound</span>
<span class="sd">            t_max: Upper bound</span>

<span class="sd">        Returns:</span>
<span class="sd">            TimeHorizon with interval constraints</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If t_min &gt;= t_max</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">t_min</span> <span class="o">&gt;=</span> <span class="n">t_max</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interval time horizon must have t_min &lt; t_max, got (</span><span class="si">{</span><span class="n">t_min</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">t_max</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">symbolic_set</span><span class="o">=</span><span class="n">syp</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">),</span> <span class="n">constraint</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t_min</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t_max</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">open_interval</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">t_min</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Factory: T = (t_min, t_max) (open interval).</span>

<span class="sd">        Args:</span>
<span class="sd">            t_min: Lower bound</span>
<span class="sd">            t_max: Upper bound</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">t_min</span> <span class="o">&gt;=</span> <span class="n">t_max</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interval time horizon must have t_min &lt; t_max, got (</span><span class="si">{</span><span class="n">t_min</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">t_max</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">symbolic_set</span><span class="o">=</span><span class="n">syp</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span> <span class="n">constraint</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t_min</span> <span class="o">&lt;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_max</span><span class="p">)</span>


        <span class="c1">### --- Properties --- ### </span>


    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        CURRENTLY NOT IMPLEMENTED - DEFERRED TO FUTURE VERSIONS</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: Volume of T</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Length is not implemented for TimeHorizon&quot;</span><span class="p">)</span>


        <span class="c1">### --- Dunder Methods --- ### </span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span> 
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;TimeHorizon(constraint=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">): No symbolic representation&quot;</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span> 
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;TimeHorizon(&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;symbolic_set=</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;constraint=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">constraint</span><span class="o">.</span><span class="vm">__name__</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">constraint</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;None&#39;</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeHorizon</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="c1"># Equality iff mutual subset</span>
        <span class="n">left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">left</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">right</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">left</span> <span class="ow">and</span> <span class="n">right</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">eq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">eq</span> <span class="ow">is</span> <span class="bp">NotImplemented</span><span class="p">:</span>  <span class="c1"># type: ignore[comparison-overlap]</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">eq</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeHorizon</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="n">le</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">le</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeHorizon</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeHorizon</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="n">ge</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ge</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">TimeHorizon</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>  <span class="c1"># type: ignore[return-value]</span>
        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">_subseteq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  


        <span class="c1">### --- Private Methods --- ### </span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_compile_constraint</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]],</span> <span class="nb">bool</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compile symbolic set to callable for fast numerical membership testing.</span>

<span class="sd">        Only called when symbolic_set is provided but constraint is not.</span>

<span class="sd">        Strategy:</span>
<span class="sd">        - For R (unbounded): return lambda x: True (no constraint)</span>
<span class="sd">        - For Intervals: extract bounds, compile to numpy checks</span>
<span class="sd">        - For general sets: use sympy&#39;s contains (slow, but general)</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: If symbolic_set is None (should never happen)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Cannot compile constraint without symbolic_set&quot;</span>

        <span class="c1"># Special case: R </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="o">==</span> <span class="n">syp</span><span class="o">.</span><span class="n">Reals</span><span class="p">:</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="kc">True</span>

        <span class="c1"># Special case: Interval</span>
            <span class="c1">## NOTE: Open/Closed logic not yet implemented. Consumers should be using the factories, </span>
            <span class="c1">## this is just an emergency fallback.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="p">,</span> <span class="n">syp</span><span class="o">.</span><span class="n">Interval</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">start</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">is_finite</span> <span class="k">else</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
            <span class="n">b</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">end</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">is_finite</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
            <span class="k">return</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">b</span>

        <span class="c1"># General case: use sympy (slow, potentially problematic)</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">symbolic_constraint</span><span class="p">(</span><span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="n">syp</span><span class="o">.</span><span class="n">Float</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="n">contains_expr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
                <span class="c1"># SymPy returns a Boolean or a symbolic expression; coerce if possible</span>
                <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">contains_expr</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">symbolic_constraint</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="PyDynSys.core.euclidean.TimeHorizon.length" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">length</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>CURRENTLY NOT IMPLEMENTED - DEFERRED TO FUTURE VERSIONS</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Volume of T</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.TimeHorizon.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Post-construction Validation:   </p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If both symbolic_set and constraint are None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/time_horizon.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Post-construction Validation:   </span>

<span class="sd">    Raises: </span>
<span class="sd">        ValueError: If both symbolic_set and constraint are None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;PhaseSpace requires at least one representation: &quot;</span>
            <span class="s2">&quot;symbolic_set (sympy.Set) or constraint (Callable[[NDArray[np.float64]], bool]) must be provided&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">symbolic_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Compile constraint from symbolic set: yields slow containment checks</span>
        <span class="c1">## NOTE: I&#39;m not actually sure of the time complexity, need to check sympy docs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compile_constraint</span><span class="p">()</span> 
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.TimeHorizon.closed_interval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">closed_interval</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Factory: T = [t_min, t_max] (bounded interval).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_min</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bound</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_max</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.time_horizon.TimeHorizon


  
      dataclass
  " href="time_horizon/#PyDynSys.core.euclidean.time_horizon.TimeHorizon">TimeHorizon</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeHorizon with interval constraints</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If t_min &gt;= t_max</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/time_horizon.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">closed_interval</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">t_min</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory: T = [t_min, t_max] (bounded interval).</span>

<span class="sd">    Args:</span>
<span class="sd">        t_min: Lower bound</span>
<span class="sd">        t_max: Upper bound</span>

<span class="sd">    Returns:</span>
<span class="sd">        TimeHorizon with interval constraints</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If t_min &gt;= t_max</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">t_min</span> <span class="o">&gt;=</span> <span class="n">t_max</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interval time horizon must have t_min &lt; t_max, got (</span><span class="si">{</span><span class="n">t_min</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">t_max</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">symbolic_set</span><span class="o">=</span><span class="n">syp</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">),</span> <span class="n">constraint</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t_min</span> <span class="o">&lt;=</span> <span class="n">t</span> <span class="o">&lt;=</span> <span class="n">t_max</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.TimeHorizon.contains_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains_time</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Check if t is in T.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time point to test</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if t in T, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/time_horizon.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contains_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if t is in T.</span>

<span class="sd">    Args:</span>
<span class="sd">        t: Time point to test</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if t in T, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">constraint</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.TimeHorizon.contains_times" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">contains_times</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Check if all times in t are in T.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t</code>
            </td>
            <td>
                  <code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Times to test</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>bool</code></td>            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if all times in t are in T, False otherwise</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/time_horizon.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">contains_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Check if all times in t are in T.</span>

<span class="sd">    Args:</span>
<span class="sd">        t: Times to test</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if all times in t are in T, False otherwise</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">contains_time</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.TimeHorizon.open_interval" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">open_interval</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Factory: T = (t_min, t_max) (open interval).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t_min</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bound</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t_max</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bound</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/time_horizon.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">open_interval</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">t_min</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">t_max</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory: T = (t_min, t_max) (open interval).</span>

<span class="sd">    Args:</span>
<span class="sd">        t_min: Lower bound</span>
<span class="sd">        t_max: Upper bound</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">t_min</span> <span class="o">&gt;=</span> <span class="n">t_max</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interval time horizon must have t_min &lt; t_max, got (</span><span class="si">{</span><span class="n">t_min</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">t_max</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">symbolic_set</span><span class="o">=</span><span class="n">syp</span><span class="o">.</span><span class="n">Interval</span><span class="p">(</span><span class="n">t_min</span><span class="p">,</span> <span class="n">t_max</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span> <span class="n">constraint</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t_min</span> <span class="o">&lt;</span> <span class="n">t</span> <span class="o">&lt;</span> <span class="n">t_max</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="PyDynSys.core.euclidean.TimeHorizon.real_line" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">real_line</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Factory: T = R (entire real line).</p>
<p>This is the DEFAULT time horizon for non-autonomous systems.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="PyDynSys.core.euclidean.time_horizon.TimeHorizon


  
      dataclass
  " href="time_horizon/#PyDynSys.core.euclidean.time_horizon.TimeHorizon">TimeHorizon</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>TimeHorizon representing R</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/PyDynSys/core/euclidean/time_horizon.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">real_line</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;TimeHorizon&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Factory: T = R (entire real line).</span>

<span class="sd">    This is the DEFAULT time horizon for non-autonomous systems.</span>

<span class="sd">    Returns:</span>
<span class="sd">        TimeHorizon representing R</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">symbolic_set</span><span class="o">=</span><span class="n">syp</span><span class="o">.</span><span class="n">Reals</span><span class="p">,</span> <span class="n">constraint</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
      
        <script src="../../../javascript/katex-config.js"></script>
      
    
  </body>
</html>